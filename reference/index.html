<!DOCTYPE html>
<html lang="en" data-bs-theme="light">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        <link rel="canonical" href="https://cwehmeyer.github.io/bbstat/reference/">
        <link rel="shortcut icon" href="../img/favicon.ico">
        <title>API Reference - bbstat</title>
        <link href="../css/bootstrap.min.css" rel="stylesheet">
        <link href="../css/fontawesome.min.css" rel="stylesheet">
        <link href="../css/brands.min.css" rel="stylesheet">
        <link href="../css/solid.min.css" rel="stylesheet">
        <link href="../css/v4-font-face.min.css" rel="stylesheet">
        <link href="../css/base.css" rel="stylesheet">
        <link id="hljs-light" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" >
        <link id="hljs-dark" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github-dark.min.css" disabled>
        <link href="../assets/_mkdocstrings.css" rel="stylesheet">
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script>hljs.highlightAll();</script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="..">bbstat</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navbar-collapse" aria-controls="navbar-collapse" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="nav-item">
                                <a href=".." class="nav-link">Home</a>
                            </li>
                            <li class="nav-item">
                                <a href="./" class="nav-link active" aria-current="page">API Reference</a>
                            </li>
                            <li class="nav-item">
                                <a href="../changelog/" class="nav-link">Changelog</a>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ms-md-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-bs-toggle="modal" data-bs-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li class="nav-item">
                                <a rel="prev" href=".." class="nav-link">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li class="nav-item">
                                <a rel="next" href="../changelog/" class="nav-link">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                            <li class="nav-item">
                                <a href="https://github.com/cwehmeyer/bbstat/edit/master/docs/reference.md" class="nav-link"><i class="fa-brands fa-github"></i> Edit on GitHub</a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-bs-toggle="collapse" data-bs-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-body-tertiary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-bs-level="1"><a href="#api-reference" class="nav-link">API Reference</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-bs-level="2"><a href="#bbstat-package" class="nav-link">bbstat Package</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#bbstat" class="nav-link">bbstat</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#bootstrap-module" class="nav-link">bootstrap Module</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#bbstat.bootstrap" class="nav-link">bootstrap</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#bbstat.bootstrap.bootstrap" class="nav-link">bootstrap</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#evaluate-module" class="nav-link">evaluate Module</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#bbstat.evaluate" class="nav-link">evaluate</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#bbstat.evaluate.BootstrapResult" class="nav-link">BootstrapResult</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#bbstat.evaluate.credibility_interval" class="nav-link">credibility_interval</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#registry-module" class="nav-link">registry Module</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#bbstat.registry" class="nav-link">registry</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#bbstat.registry.StatisticFunction" class="nav-link">StatisticFunction</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#bbstat.registry.get_statistic_fn" class="nav-link">get_statistic_fn</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#bbstat.registry.get_statistic_fn_names" class="nav-link">get_statistic_fn_names</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#resample-module" class="nav-link">resample Module</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#bbstat.resample" class="nav-link">resample</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#bbstat.resample.resample" class="nav-link">resample</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#statistics-module" class="nav-link">statistics Module</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#bbstat.statistics" class="nav-link">statistics</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#bbstat.statistics.FArray" class="nav-link">FArray</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#bbstat.statistics.FFArray" class="nav-link">FFArray</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#bbstat.statistics.IArray" class="nav-link">IArray</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#bbstat.statistics.IFArray" class="nav-link">IFArray</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#bbstat.statistics.compute_weighted_aggregate" class="nav-link">compute_weighted_aggregate</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#bbstat.statistics.compute_weighted_entropy" class="nav-link">compute_weighted_entropy</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#bbstat.statistics.compute_weighted_eta_square_dependency" class="nav-link">compute_weighted_eta_square_dependency</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#bbstat.statistics.compute_weighted_log_odds" class="nav-link">compute_weighted_log_odds</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#bbstat.statistics.compute_weighted_mean" class="nav-link">compute_weighted_mean</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#bbstat.statistics.compute_weighted_median" class="nav-link">compute_weighted_median</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#bbstat.statistics.compute_weighted_mutual_information" class="nav-link">compute_weighted_mutual_information</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#bbstat.statistics.compute_weighted_pearson_dependency" class="nav-link">compute_weighted_pearson_dependency</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#bbstat.statistics.compute_weighted_percentile" class="nav-link">compute_weighted_percentile</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#bbstat.statistics.compute_weighted_probability" class="nav-link">compute_weighted_probability</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#bbstat.statistics.compute_weighted_quantile" class="nav-link">compute_weighted_quantile</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#bbstat.statistics.compute_weighted_self_information" class="nav-link">compute_weighted_self_information</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#bbstat.statistics.compute_weighted_spearman_dependency" class="nav-link">compute_weighted_spearman_dependency</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#bbstat.statistics.compute_weighted_std" class="nav-link">compute_weighted_std</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#bbstat.statistics.compute_weighted_sum" class="nav-link">compute_weighted_sum</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#bbstat.statistics.compute_weighted_variance" class="nav-link">compute_weighted_variance</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<h1 id="api-reference">API Reference</h1>
<p>This section documents the public API of the <code>bbstat</code> package.</p>
<hr />
<h2 id="bbstat-package"><code>bbstat</code> Package</h2>


<div class="doc doc-object doc-module">



<a id="bbstat"></a>
    <div class="doc doc-contents first">

        <p>bbstat: Bayesian Bootstrap Utilities</p>
<p>This package provides tools for performing and evaluating the Bayesian bootstrap,
a resampling method based on the Bayesian interpretation of uncertainty.</p>


<details class="main-features" open>
  <summary>Main Features</summary>
  <ul>
<li><code>bootstrap</code>: Run the Bayesian bootstrap on compatible data structures.</li>
<li><code>BootstrapResult</code>: Analyze bootstrap outcomes with mean estimates and credibility intervals.</li>
<li><code>credibility_interval</code>: Compute one-dimensional credibility intervals from samples.</li>
<li><code>resample</code>: Generate weighted samples using the Dirichlet distribution.</li>
<li><code>statistics</code>: Collection of built-in weighted statistics.</li>
</ul>
</details>

<details class="supported-statistic-functions" open>
  <summary>Supported Statistic Functions</summary>
  <p>Custom statistic functions must accept the signature:</p>
<p><code>(data: ..., weights: numpy.typing.NDarray[numpy.floating], **kwargs) -&gt; float</code></p>
<p>Compatible examples in bbstat.statistics include:</p>
<ul>
<li><code>compute_weighted_entropy</code>: Weighted entropy</li>
<li><code>compute_weighted_eta_square_dependency</code>: Weighted eta-squared for categorical group differences</li>
<li><code>compute_weighted_log_odds</code>: Weighted log-odds of a selected state</li>
<li><code>compute_weighted_mean</code>: Weighted mean estimate</li>
<li><code>compute_weighted_median</code>: Weighted median estimate</li>
<li><code>compute_weighted_mutual_information</code>: Weighted mutual information</li>
<li><code>compute_weighted_pearson_dependency</code>: Weighted Pearson correlation</li>
<li><code>compute_weighted_percentile</code>: Weighted percentile estimate</li>
<li><code>compute_weighted_probability</code>: Weighted probability of a selected state</li>
<li><code>compute_weighted_quantile</code>: Weighted quantile estimate</li>
<li><code>compute_weighted_self_information</code>: Weighted self-information of a selected state</li>
<li><code>compute_weighted_spearman_dependency</code>: Weighted Spearman correlation</li>
<li><code>compute_weighted_std</code>: Weighted standard deviation estimate</li>
<li><code>compute_weighted_sum</code>: Weighted sum estimate</li>
<li><code>compute_weighted_variance</code>: Weighted variance estimate</li>
</ul>
</details>

<p><span class="doc-section-title">Modules:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="bbstat.- `bootstrap`">- `bootstrap`</span></code></td>
            <td>
              <div class="doc-md-description">
                <p>Core logic for Bayesian bootstrap</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="bbstat.- `evaluate`">- `evaluate`</span></code></td>
            <td>
              <div class="doc-md-description">
                <p>Tools for summarizing bootstrap results</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="bbstat.- `registry`">- `registry`</span></code></td>
            <td>
              <div class="doc-md-description">
                <p>Registry for built-in statistic functions</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="bbstat.- `resample`">- `resample`</span></code></td>
            <td>
              <div class="doc-md-description">
                <p>Weighted resampling function</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="bbstat.- `statistics`">- `statistics`</span></code></td>
            <td>
              <div class="doc-md-description">
                <p>Built-in statistic functions</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>










  <div class="doc doc-children">












  </div>

    </div>

</div><hr />
<h2 id="bootstrap-module"><code>bootstrap</code> Module</h2>


<div class="doc doc-object doc-module">



<a id="bbstat.bootstrap"></a>
    <div class="doc doc-contents first">

        <p>Bayesian bootstrap resampling for statistical estimation and uncertainty quantification.</p>
<p>This module provides the <code>bootstrap</code> function, which applies the Bayesian bootstrap
resampling method to estimate a statistic (such as the mean or median) along with its
credibility interval. It supports flexible input data formats, user-defined or
registered statistic functions, and additional customization via keyword arguments.</p>
<p>The function is designed for use in probabilistic data analysis workflows, where
quantifying uncertainty through resampling is critical. It is particularly well-suited
for small to moderate datasets and non-parametric inference.</p>


<details class="main-features" open>
  <summary>Main Features</summary>
  <ul>
<li>Resampling via the Bayesian bootstrap method.</li>
<li>Support for scalar or multivariate data inputs.</li>
<li>Use of string-based or function-based statistic definitions.</li>
<li>Configurable number of resamples and credibility interval coverage.</li>
<li>Optional blockwise resampling for structured data.</li>
<li>Random seed control for reproducibility.</li>
</ul>
</details>

<details class="example" open>
  <summary>Example</summary>
  <pre><code class="language-python">import numpy as np
from bbstat.bootstrap import bootstrap
data = np.random.randn(100)
result = bootstrap(data, statistic_fn=&quot;mean&quot;)
print(result)
</code></pre>
</details>        <p>See the function-level docstring of <code>bootstrap</code> for full details.</p>










  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h2 id="bbstat.bootstrap.bootstrap" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">bootstrap</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">statistic_fn</span><span class="p">,</span> <span class="n">n_boot</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">coverage</span><span class="o">=</span><span class="mf">0.87</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">blocksize</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fn_kwargs</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Performs Bayesian bootstrap resampling to estimate a statistic and its credibility interval.</p>
<p>This function performs Bayesian bootstrap resampling by generating <code>n_boot</code> resamples from
the provided <code>data</code> and applying the specified statistic function (<code>statistic_fn</code>). It then
computes the mean and credibility interval for the estimated statistic across all resamples.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>data</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The data to be resampled. It can be a 1D array, a tuple,
or a list of arrays where each element represents a different group of data to resample.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>statistic_fn</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="str">str</span>, <span title="StatisticFunction">StatisticFunction</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The statistic function to be applied on each
bootstrap resample. It can either be the name of a registered statistic function or the
function itself.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>n_boot</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The number of bootstrap resamples to generate. Default is 1000.</p>
              </div>
            </td>
            <td>
                  <code>1000</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>coverage</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The coverage level for the credibility interval (between 0 and 1).
Default is 0.87.</p>
              </div>
            </td>
            <td>
                  <code>0.87</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>seed</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A seed for the random number generator to ensure reproducibility.
Default is <code>None</code>, which means no fixed seed.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>blocksize</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The block size for resampling. If provided, resampling weights
are generated in blocks of this size. Defaults to <code>None</code>, meaning all resampling weights
are generated at once.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>fn_kwargs</code>
            </td>
            <td>
                  <code><span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Additional keyword arguments to be passed to
the <code>statistic_fn</code> for each resample. Default is <code>None</code>.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>BootstrapResult</code></td>            <td>
                  <code><a class="autorefs autorefs-internal" title="BootstrapResult


  
      dataclass
   (bbstat.evaluate.BootstrapResult)" href="#bbstat.evaluate.BootstrapResult">BootstrapResult</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>An object containing the mean of the resampled statistics, the credibility
interval, and other details of the bootstrap procedure.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If any data array is not 1D or if the dimensions of the input arrays do not match.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <pre><code class="language-python">data = np.random.randn(100)
statistic_fn = &quot;mean&quot;
result = bootstrap(data, statistic_fn)
print(result.mean)
print(result.ci)
</code></pre>
</details>

<details class="notes" open>
  <summary>Notes</summary>
  <ul>
<li>The <code>data</code> argument can be a single 1D array, or a tuple or list of 1D arrays where each array
  represents a feature of the data.</li>
<li>The <code>statistic_fn</code> can either be the name of a registered function (as a string) or the function
  itself. If a string is provided, it must match the name of a function in the <code>statistics.registry</code>.</li>
<li>The function uses the <code>resample</code> function to generate bootstrap resamples and apply the statistic
  function to each resample.</li>
<li>The default <code>coverage</code> level of 0.87 corresponds to a 87% credibility interval, but this can be
  adjusted as needed.</li>
</ul>
</details>

            <details class="quote">
              <summary>Source code in <code>bbstat/bootstrap.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">bootstrap</span><span class="p">(</span>
    <span class="n">data</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>
    <span class="n">statistic_fn</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Callable</span><span class="p">],</span>
    <span class="n">n_boot</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">,</span>
    <span class="n">coverage</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.87</span><span class="p">,</span>
    <span class="n">seed</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">blocksize</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">fn_kwargs</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">BootstrapResult</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Performs Bayesian bootstrap resampling to estimate a statistic and its credibility interval.</span>

<span class="sd">    This function performs Bayesian bootstrap resampling by generating `n_boot` resamples from</span>
<span class="sd">    the provided `data` and applying the specified statistic function (`statistic_fn`). It then</span>
<span class="sd">    computes the mean and credibility interval for the estimated statistic across all resamples.</span>

<span class="sd">    Args:</span>
<span class="sd">        data (Any): The data to be resampled. It can be a 1D array, a tuple,</span>
<span class="sd">            or a list of arrays where each element represents a different group of data to resample.</span>
<span class="sd">        statistic_fn (Union[str, StatisticFunction]): The statistic function to be applied on each</span>
<span class="sd">            bootstrap resample. It can either be the name of a registered statistic function or the</span>
<span class="sd">            function itself.</span>
<span class="sd">        n_boot (int, optional): The number of bootstrap resamples to generate. Default is 1000.</span>
<span class="sd">        coverage (float, optional): The coverage level for the credibility interval (between 0 and 1).</span>
<span class="sd">            Default is 0.87.</span>
<span class="sd">        seed (int, optional): A seed for the random number generator to ensure reproducibility.</span>
<span class="sd">            Default is `None`, which means no fixed seed.</span>
<span class="sd">        blocksize (int, optional): The block size for resampling. If provided, resampling weights</span>
<span class="sd">            are generated in blocks of this size. Defaults to `None`, meaning all resampling weights</span>
<span class="sd">            are generated at once.</span>
<span class="sd">        fn_kwargs (Dict[str, Any], optional): Additional keyword arguments to be passed to</span>
<span class="sd">            the `statistic_fn` for each resample. Default is `None`.</span>

<span class="sd">    Returns:</span>
<span class="sd">        BootstrapResult: An object containing the mean of the resampled statistics, the credibility</span>
<span class="sd">            interval, and other details of the bootstrap procedure.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If any data array is not 1D or if the dimensions of the input arrays do not match.</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        data = np.random.randn(100)</span>
<span class="sd">        statistic_fn = &quot;mean&quot;</span>
<span class="sd">        result = bootstrap(data, statistic_fn)</span>
<span class="sd">        print(result.mean)</span>
<span class="sd">        print(result.ci)</span>
<span class="sd">        ```</span>

<span class="sd">    Notes:</span>
<span class="sd">        - The `data` argument can be a single 1D array, or a tuple or list of 1D arrays where each array</span>
<span class="sd">          represents a feature of the data.</span>
<span class="sd">        - The `statistic_fn` can either be the name of a registered function (as a string) or the function</span>
<span class="sd">          itself. If a string is provided, it must match the name of a function in the `statistics.registry`.</span>
<span class="sd">        - The function uses the `resample` function to generate bootstrap resamples and apply the statistic</span>
<span class="sd">          function to each resample.</span>
<span class="sd">        - The default `coverage` level of 0.87 corresponds to a 87% credibility interval, but this can be</span>
<span class="sd">          adjusted as needed.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">ndim</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid parameter </span><span class="si">{</span><span class="n">data</span><span class="o">.</span><span class="n">ndim</span><span class="si">=:}</span><span class="s2">: must be 1.&quot;</span><span class="p">)</span>
        <span class="n">n_data</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="p">(</span><span class="nb">tuple</span><span class="p">,</span> <span class="nb">list</span><span class="p">)):</span>
        <span class="n">n_data</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">array</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">array</span><span class="o">.</span><span class="n">ndim</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid parameter </span><span class="si">{</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">ndim</span><span class="si">=:}</span><span class="s2">: must be 1.&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">n_data</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">array</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Invalid parameter </span><span class="si">{</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">=:}</span><span class="s2">: must be </span><span class="si">{</span><span class="n">n_data</span><span class="si">=:}</span><span class="s2">.&quot;</span>
                <span class="p">)</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">statistic_fn</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">statistic_fn</span> <span class="o">=</span> <span class="n">get_statistic_fn</span><span class="p">(</span><span class="n">statistic_fn</span><span class="p">)</span>
    <span class="n">estimates</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
        <span class="p">[</span>
            <span class="n">statistic_fn</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="n">weights</span><span class="p">,</span> <span class="o">**</span><span class="p">(</span><span class="n">fn_kwargs</span> <span class="ow">or</span> <span class="p">{}))</span>
            <span class="k">for</span> <span class="n">weights</span> <span class="ow">in</span> <span class="n">resample</span><span class="p">(</span>
                <span class="n">n_boot</span><span class="o">=</span><span class="n">n_boot</span><span class="p">,</span>
                <span class="n">n_data</span><span class="o">=</span><span class="n">n_data</span><span class="p">,</span>
                <span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">,</span>
                <span class="n">blocksize</span><span class="o">=</span><span class="n">blocksize</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">]</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">BootstrapResult</span><span class="p">(</span><span class="n">estimates</span><span class="o">=</span><span class="n">estimates</span><span class="p">,</span> <span class="n">coverage</span><span class="o">=</span><span class="n">coverage</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><hr />
<h2 id="evaluate-module"><code>evaluate</code> Module</h2>


<div class="doc doc-object doc-module">



<a id="bbstat.evaluate"></a>
    <div class="doc doc-contents first">

        <p>Evaluation utilities for summarizing bootstrap resampling results.</p>
<p>This module provides functions and data structures for interpreting and summarizing
the output of Bayesian bootstrap resampling procedures. It includes tools to compute
credibility intervals for statistical estimates and to encapsulate the results of a
bootstrap analysis in a convenient data class.</p>


<details class="main-features" open>
  <summary>Main Features</summary>
  <ul>
<li><code>credibility_interval</code>: Computes a credibility interval from a set of estimates.</li>
<li><code>BootstrapResult</code>: A data class that holds bootstrap estimates, computes the mean,
  and automatically evaluates the credibility interval.</li>
</ul>
</details>

<details class="example" open>
  <summary>Example</summary>
  <pre><code class="language-python">from bbstat.evaluate import BootstrapResult
result = BootstrapResult(estimates=np.array([5.0, 2.3, 2.9]), coverage=0.95)
print(result)  # =&gt; BootstrapResult(mean=3.4, ci=(2.3, 4.9), coverage=0.95, n_boot=3)
</code></pre>
</details>

<details class="notes" open>
  <summary>Notes</summary>
  <ul>
<li>The credibility interval is calculated using quantiles of the empirical distribution
  of bootstrap estimates.</li>
<li>This module is designed to be used alongside the <code>bootstrap</code> and <code>resample</code> modules
  to provide complete statistical summaries of resampled data.</li>
</ul>
</details>









  <div class="doc doc-children">









<div class="doc doc-object doc-class">



<h2 id="bbstat.evaluate.BootstrapResult" class="doc doc-heading">
            <code>BootstrapResult</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h2>


    <div class="doc doc-contents ">


        <p>A class representing the result of a bootstrap resampling procedure.</p>
<p>This class stores the mean, credibility interval, and other statistics resulting
from a Bayesian bootstrap analysis, and provides methods to display the results and
calculate related statistics such as the credibility interval.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="bbstat.evaluate.BootstrapResult.mean">mean</span></code></td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The mean of the bootstrap estimates.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="bbstat.evaluate.BootstrapResult.ci">ci</span></code></td>
            <td>
                  <code><span title="typing.Tuple">Tuple</span>[<span title="float">float</span>, <span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The lower and upper bounds of the credibility interval.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="bbstat.evaluate.BootstrapResult.coverage">coverage</span></code></td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The desired coverage for the credibility interval (between 0 and 1).</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="bbstat.evaluate.BootstrapResult.n_boot">n_boot</span></code></td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The number of bootstrap resamples (i.e., the number of estimates).</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="bbstat.evaluate.BootstrapResult.estimates">estimates</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="FArray = NDArray[np.floating]

  
      module-attribute
   (bbstat.statistics.FArray)" href="#bbstat.statistics.FArray">FArray</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The array of bootstrap resample estimates.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Methods:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="__post_init__() (bbstat.evaluate.BootstrapResult.__post_init__)" href="#bbstat.evaluate.BootstrapResult.__post_init__">__post_init__</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Initializes the <code>mean</code>, <code>ci</code>, and <code>n_boot</code> attributes.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="__str__() (bbstat.evaluate.BootstrapResult.__str__)" href="#bbstat.evaluate.BootstrapResult.__str__">__str__</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Returns a string representation of the object.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="credibility_interval(coverage) (bbstat.evaluate.BootstrapResult.credibility_interval)" href="#bbstat.evaluate.BootstrapResult.credibility_interval">credibility_interval</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Calculates the credibility interval for the bootstrap estimates.</p>
                </div>
              </td>
            </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>estimates</code> is not a 1D array or if <code>coverage</code> is not between 0 and 1
(exclusive).</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>








              <details class="quote">
                <summary>Source code in <code>bbstat/evaluate.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">BootstrapResult</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A class representing the result of a bootstrap resampling procedure.</span>

<span class="sd">    This class stores the mean, credibility interval, and other statistics resulting</span>
<span class="sd">    from a Bayesian bootstrap analysis, and provides methods to display the results and</span>
<span class="sd">    calculate related statistics such as the credibility interval.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        mean (float): The mean of the bootstrap estimates.</span>
<span class="sd">        ci (Tuple[float, float]): The lower and upper bounds of the credibility interval.</span>
<span class="sd">        coverage (float): The desired coverage for the credibility interval (between 0 and 1).</span>
<span class="sd">        n_boot (int): The number of bootstrap resamples (i.e., the number of estimates).</span>
<span class="sd">        estimates (FArray): The array of bootstrap resample estimates.</span>

<span class="sd">    Methods:</span>
<span class="sd">        __post_init__: Initializes the `mean`, `ci`, and `n_boot` attributes.</span>
<span class="sd">        __str__: Returns a string representation of the object.</span>
<span class="sd">        credibility_interval: Calculates the credibility interval for the bootstrap estimates.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If `estimates` is not a 1D array or if `coverage` is not between 0 and 1</span>
<span class="sd">            (exclusive).</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">mean</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ci</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">coverage</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">n_boot</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">estimates</span><span class="p">:</span> <span class="n">FArray</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">__post_init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Post-initialization method to initialize the mean, credibility interval,</span>
<span class="sd">        and the number of bootstrap resamples from the provided estimates and</span>
<span class="sd">        coverage paremeters.</span>

<span class="sd">        This method is automatically called after the object is initialized.</span>
<span class="sd">        It calculates:</span>
<span class="sd">            - The mean of the bootstrap estimates.</span>
<span class="sd">            - The credibility interval using the provided coverage.</span>
<span class="sd">            - The number of bootstrap resamples.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: If `estimates` is not a 1D array or if `coverage` is not</span>
<span class="sd">                between 0 and 1 (exclusive).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">estimates</span><span class="p">)</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ci</span> <span class="o">=</span> <span class="n">credibility_interval</span><span class="p">(</span>
            <span class="n">estimates</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">estimates</span><span class="p">,</span>
            <span class="n">coverage</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">coverage</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n_boot</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">estimates</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">ndigits</span><span class="p">(</span><span class="n">ci</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns number of digits for rounding.</span>

<span class="sd">        This method computes the number of digits for rounding mean and credibility</span>
<span class="sd">        interval values for better readability. If the credibility interval has width</span>
<span class="sd">        zero, we round to zero digits. Otherwise, we take one minus the floored order</span>
<span class="sd">        of magnitude of the width.</span>

<span class="sd">        Args:</span>
<span class="sd">            ci (Tuple[float, float]): The lower and upper bounds of the credibility</span>
<span class="sd">                interval.</span>

<span class="sd">        Returns:</span>
<span class="sd">            int: The number of digits for readable rounding.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">lo</span><span class="p">,</span> <span class="n">hi</span> <span class="o">=</span> <span class="n">ci</span>
        <span class="n">width</span> <span class="o">=</span> <span class="n">hi</span> <span class="o">-</span> <span class="n">lo</span>
        <span class="k">if</span> <span class="n">width</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">0</span>
        <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">math</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">width</span><span class="p">))))</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a human-readable string representation of the bootstrap result.</span>

<span class="sd">        This method formats the mean, credibility interval, coverage, and the</span>
<span class="sd">        number of bootstrap resamples for display.</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: A formatted string representing the bootstrap result.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ndigits</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ndigits</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ci</span><span class="p">)</span>
        <span class="n">mean</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">number</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span> <span class="n">ndigits</span><span class="o">=</span><span class="n">ndigits</span><span class="p">)</span>
        <span class="n">lo</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">number</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ci</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ndigits</span><span class="o">=</span><span class="n">ndigits</span><span class="p">)</span>
        <span class="n">hi</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">number</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ci</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">ndigits</span><span class="o">=</span><span class="n">ndigits</span><span class="p">)</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;BootstrapResult(mean=</span><span class="si">{</span><span class="n">mean</span><span class="si">}</span><span class="s2">, ci=</span><span class="si">{</span><span class="p">(</span><span class="n">lo</span><span class="p">,</span><span class="w"> </span><span class="n">hi</span><span class="p">)</span><span class="si">}</span><span class="s2">, coverage=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">coverage</span><span class="si">}</span><span class="s2">, n_boot=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">n_boot</span><span class="si">}</span><span class="s2">)&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">credibility_interval</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">coverage</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculate the credibility interval for the bootstrap estimates.</span>

<span class="sd">        This method is a wrapper for the `credibility_interval` function. It takes</span>
<span class="sd">        a `coverage` value (between 0 and 1) and returns the lower and upper bounds</span>
<span class="sd">        of the credibility interval.</span>

<span class="sd">        Args:</span>
<span class="sd">            coverage (float): The desired coverage for the credibility interval</span>
<span class="sd">                (must be between 0 and 1).</span>

<span class="sd">        Returns:</span>
<span class="sd">            Tuple[float, float]: The lower and upper bounds of the credibility</span>
<span class="sd">                interval based on the given coverage.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: If the `coverage` is not between 0 and 1.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">credibility_interval</span><span class="p">(</span><span class="n">estimates</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">estimates</span><span class="p">,</span> <span class="n">coverage</span><span class="o">=</span><span class="n">coverage</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">plot</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">ax</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">plt</span><span class="o">.</span><span class="n">Axes</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">coverage</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">n_grid</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">200</span><span class="p">,</span>
        <span class="n">label</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">plt</span><span class="o">.</span><span class="n">Axes</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plot the kernel density estimate (KDE) of bootstrap estimates with</span>
<span class="sd">        credibility interval shading and a vertical line at the mean.</span>

<span class="sd">        If an axis is provided, the plot is drawn on it; otherwise, a new figure and axis are created.</span>
<span class="sd">        Displays a shaded credibility interval and labels the plot with a formatted mean</span>
<span class="sd">        and interval. If no axis is provided, the figure further is annotated with a title and ylabel,</span>
<span class="sd">        ylim[0] positioned at zero, the legend is set, and a tight layout applied.</span>

<span class="sd">        Args:</span>
<span class="sd">            ax (plt.Axes, optional): Matplotlib axis to draw the plot on. If None, a new axis is created.</span>
<span class="sd">            coverage (float, optional): Credibility interval coverage (e.g., 0.95 for 95% CI).</span>
<span class="sd">                If None, uses the default stored in `self.ci`. Default is None.</span>
<span class="sd">            n_grid (int): Number of grid points to use for evaluating the KDE, default is 200.</span>
<span class="sd">            label (str, optional): Optional label for the line. If provided, the label is</span>
<span class="sd">                extended to include the mean and credibility interval.</span>

<span class="sd">        Returns:</span>
<span class="sd">            plt.Axes: The axis object containing the plot.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mf">4.5</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">fig</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="n">coverage</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">ci</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ci</span>
            <span class="n">coverage</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">coverage</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ci</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">credibility_interval</span><span class="p">(</span><span class="n">coverage</span><span class="o">=</span><span class="n">coverage</span><span class="p">)</span>
        <span class="n">lo</span><span class="p">,</span> <span class="n">hi</span> <span class="o">=</span> <span class="n">ci</span>

        <span class="n">ndigits</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ndigits</span><span class="p">(</span><span class="n">ci</span><span class="o">=</span><span class="n">ci</span><span class="p">)</span>
        <span class="n">param_str</span> <span class="o">=</span> <span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span><span class="w"> </span><span class="n">ndigits</span><span class="p">)</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">lo</span><span class="p">,</span><span class="w"> </span><span class="n">ndigits</span><span class="p">)</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">hi</span><span class="p">,</span><span class="w"> </span><span class="n">ndigits</span><span class="p">)</span><span class="si">}</span><span class="s2">)&quot;</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">label</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">param_str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">label</span><span class="si">}</span><span class="s2">=</span><span class="si">{</span><span class="n">param_str</span><span class="si">}</span><span class="s2">&quot;</span>

        <span class="n">p</span> <span class="o">=</span> <span class="n">gaussian_kde</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">estimates</span><span class="p">)</span>

        <span class="n">x_grid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">estimates</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">estimates</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">n_grid</span><span class="p">)</span>
        <span class="n">within_ci</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logical_and</span><span class="p">(</span><span class="n">x_grid</span> <span class="o">&gt;=</span> <span class="n">lo</span><span class="p">,</span> <span class="n">x_grid</span> <span class="o">&lt;=</span> <span class="n">hi</span><span class="p">)</span>
        <span class="n">y_grid</span> <span class="o">=</span> <span class="n">p</span><span class="p">(</span><span class="n">x_grid</span><span class="p">)</span>
        <span class="n">y_mean</span> <span class="o">=</span> <span class="n">p</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">mean</span><span class="p">])</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>

        <span class="p">(</span><span class="n">line</span><span class="p">,)</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_grid</span><span class="p">,</span> <span class="n">y_grid</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">param_str</span><span class="p">)</span>
        <span class="n">color</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">get_color</span><span class="p">()</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span>
            <span class="n">x_grid</span><span class="p">[</span><span class="n">within_ci</span><span class="p">],</span>
            <span class="mi">0</span><span class="p">,</span>
            <span class="n">y_grid</span><span class="p">[</span><span class="n">within_ci</span><span class="p">],</span>
            <span class="n">facecolor</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
            <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">mean</span><span class="p">]</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">y_mean</span><span class="p">],</span> <span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">mean</span><span class="p">],</span> <span class="p">[</span><span class="n">y_mean</span><span class="p">],</span> <span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">fig</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Bayesian bootstrap    </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">n_boot</span><span class="si">}</span><span class="s2"> resamples, </span><span class="si">{</span><span class="n">coverage</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">100</span><span class="si">:</span><span class="s2">.0f</span><span class="si">}</span><span class="s2">% CI&quot;</span>
            <span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()[</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Distribution of estimates&quot;</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">ax</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h3 id="bbstat.evaluate.BootstrapResult.__post_init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">__post_init__</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Post-initialization method to initialize the mean, credibility interval,
and the number of bootstrap resamples from the provided estimates and
coverage paremeters.</p>
<p>This method is automatically called after the object is initialized.
It calculates:
    - The mean of the bootstrap estimates.
    - The credibility interval using the provided coverage.
    - The number of bootstrap resamples.</p>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>estimates</code> is not a 1D array or if <code>coverage</code> is not
between 0 and 1 (exclusive).</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>bbstat/evaluate.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">__post_init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Post-initialization method to initialize the mean, credibility interval,</span>
<span class="sd">    and the number of bootstrap resamples from the provided estimates and</span>
<span class="sd">    coverage paremeters.</span>

<span class="sd">    This method is automatically called after the object is initialized.</span>
<span class="sd">    It calculates:</span>
<span class="sd">        - The mean of the bootstrap estimates.</span>
<span class="sd">        - The credibility interval using the provided coverage.</span>
<span class="sd">        - The number of bootstrap resamples.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If `estimates` is not a 1D array or if `coverage` is not</span>
<span class="sd">            between 0 and 1 (exclusive).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">estimates</span><span class="p">)</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">ci</span> <span class="o">=</span> <span class="n">credibility_interval</span><span class="p">(</span>
        <span class="n">estimates</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">estimates</span><span class="p">,</span>
        <span class="n">coverage</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">coverage</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">n_boot</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">estimates</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="bbstat.evaluate.BootstrapResult.__str__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__str__</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Returns a human-readable string representation of the bootstrap result.</p>
<p>This method formats the mean, credibility interval, coverage, and the
number of bootstrap resamples for display.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>str</code></td>            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A formatted string representing the bootstrap result.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>bbstat/evaluate.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a human-readable string representation of the bootstrap result.</span>

<span class="sd">    This method formats the mean, credibility interval, coverage, and the</span>
<span class="sd">    number of bootstrap resamples for display.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: A formatted string representing the bootstrap result.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ndigits</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ndigits</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ci</span><span class="p">)</span>
    <span class="n">mean</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">number</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span> <span class="n">ndigits</span><span class="o">=</span><span class="n">ndigits</span><span class="p">)</span>
    <span class="n">lo</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">number</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ci</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ndigits</span><span class="o">=</span><span class="n">ndigits</span><span class="p">)</span>
    <span class="n">hi</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">number</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ci</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">ndigits</span><span class="o">=</span><span class="n">ndigits</span><span class="p">)</span>
    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;BootstrapResult(mean=</span><span class="si">{</span><span class="n">mean</span><span class="si">}</span><span class="s2">, ci=</span><span class="si">{</span><span class="p">(</span><span class="n">lo</span><span class="p">,</span><span class="w"> </span><span class="n">hi</span><span class="p">)</span><span class="si">}</span><span class="s2">, coverage=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">coverage</span><span class="si">}</span><span class="s2">, n_boot=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">n_boot</span><span class="si">}</span><span class="s2">)&quot;</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="bbstat.evaluate.BootstrapResult.credibility_interval" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">credibility_interval</span><span class="p">(</span><span class="n">coverage</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Calculate the credibility interval for the bootstrap estimates.</p>
<p>This method is a wrapper for the <code>credibility_interval</code> function. It takes
a <code>coverage</code> value (between 0 and 1) and returns the lower and upper bounds
of the credibility interval.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>coverage</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The desired coverage for the credibility interval
(must be between 0 and 1).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Tuple">Tuple</span>[<span title="float">float</span>, <span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Tuple[float, float]: The lower and upper bounds of the credibility
interval based on the given coverage.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the <code>coverage</code> is not between 0 and 1.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>bbstat/evaluate.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">credibility_interval</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">coverage</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculate the credibility interval for the bootstrap estimates.</span>

<span class="sd">    This method is a wrapper for the `credibility_interval` function. It takes</span>
<span class="sd">    a `coverage` value (between 0 and 1) and returns the lower and upper bounds</span>
<span class="sd">    of the credibility interval.</span>

<span class="sd">    Args:</span>
<span class="sd">        coverage (float): The desired coverage for the credibility interval</span>
<span class="sd">            (must be between 0 and 1).</span>

<span class="sd">    Returns:</span>
<span class="sd">        Tuple[float, float]: The lower and upper bounds of the credibility</span>
<span class="sd">            interval based on the given coverage.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If the `coverage` is not between 0 and 1.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">credibility_interval</span><span class="p">(</span><span class="n">estimates</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">estimates</span><span class="p">,</span> <span class="n">coverage</span><span class="o">=</span><span class="n">coverage</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="bbstat.evaluate.BootstrapResult.ndigits" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">ndigits</span><span class="p">(</span><span class="n">ci</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Returns number of digits for rounding.</p>
<p>This method computes the number of digits for rounding mean and credibility
interval values for better readability. If the credibility interval has width
zero, we round to zero digits. Otherwise, we take one minus the floored order
of magnitude of the width.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>ci</code>
            </td>
            <td>
                  <code><span title="typing.Tuple">Tuple</span>[<span title="float">float</span>, <span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The lower and upper bounds of the credibility
interval.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>int</code></td>            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The number of digits for readable rounding.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>bbstat/evaluate.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">ndigits</span><span class="p">(</span><span class="n">ci</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns number of digits for rounding.</span>

<span class="sd">    This method computes the number of digits for rounding mean and credibility</span>
<span class="sd">    interval values for better readability. If the credibility interval has width</span>
<span class="sd">    zero, we round to zero digits. Otherwise, we take one minus the floored order</span>
<span class="sd">    of magnitude of the width.</span>

<span class="sd">    Args:</span>
<span class="sd">        ci (Tuple[float, float]): The lower and upper bounds of the credibility</span>
<span class="sd">            interval.</span>

<span class="sd">    Returns:</span>
<span class="sd">        int: The number of digits for readable rounding.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">lo</span><span class="p">,</span> <span class="n">hi</span> <span class="o">=</span> <span class="n">ci</span>
    <span class="n">width</span> <span class="o">=</span> <span class="n">hi</span> <span class="o">-</span> <span class="n">lo</span>
    <span class="k">if</span> <span class="n">width</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">0</span>
    <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">math</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">width</span><span class="p">))))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="bbstat.evaluate.BootstrapResult.plot" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">coverage</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">n_grid</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Plot the kernel density estimate (KDE) of bootstrap estimates with
credibility interval shading and a vertical line at the mean.</p>
<p>If an axis is provided, the plot is drawn on it; otherwise, a new figure and axis are created.
Displays a shaded credibility interval and labels the plot with a formatted mean
and interval. If no axis is provided, the figure further is annotated with a title and ylabel,
ylim[0] positioned at zero, the legend is set, and a tight layout applied.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>ax</code>
            </td>
            <td>
                  <code><span title="matplotlib.pyplot.Axes">Axes</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Matplotlib axis to draw the plot on. If None, a new axis is created.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>coverage</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Credibility interval coverage (e.g., 0.95 for 95% CI).
If None, uses the default stored in <code>self.ci</code>. Default is None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>n_grid</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of grid points to use for evaluating the KDE, default is 200.</p>
              </div>
            </td>
            <td>
                  <code>200</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>label</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional label for the line. If provided, the label is
extended to include the mean and credibility interval.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="matplotlib.pyplot.Axes">Axes</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>plt.Axes: The axis object containing the plot.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>bbstat/evaluate.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plot</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">ax</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">plt</span><span class="o">.</span><span class="n">Axes</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">coverage</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">n_grid</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">200</span><span class="p">,</span>
    <span class="n">label</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">plt</span><span class="o">.</span><span class="n">Axes</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plot the kernel density estimate (KDE) of bootstrap estimates with</span>
<span class="sd">    credibility interval shading and a vertical line at the mean.</span>

<span class="sd">    If an axis is provided, the plot is drawn on it; otherwise, a new figure and axis are created.</span>
<span class="sd">    Displays a shaded credibility interval and labels the plot with a formatted mean</span>
<span class="sd">    and interval. If no axis is provided, the figure further is annotated with a title and ylabel,</span>
<span class="sd">    ylim[0] positioned at zero, the legend is set, and a tight layout applied.</span>

<span class="sd">    Args:</span>
<span class="sd">        ax (plt.Axes, optional): Matplotlib axis to draw the plot on. If None, a new axis is created.</span>
<span class="sd">        coverage (float, optional): Credibility interval coverage (e.g., 0.95 for 95% CI).</span>
<span class="sd">            If None, uses the default stored in `self.ci`. Default is None.</span>
<span class="sd">        n_grid (int): Number of grid points to use for evaluating the KDE, default is 200.</span>
<span class="sd">        label (str, optional): Optional label for the line. If provided, the label is</span>
<span class="sd">            extended to include the mean and credibility interval.</span>

<span class="sd">    Returns:</span>
<span class="sd">        plt.Axes: The axis object containing the plot.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mf">4.5</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">if</span> <span class="n">coverage</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ci</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ci</span>
        <span class="n">coverage</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">coverage</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">ci</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">credibility_interval</span><span class="p">(</span><span class="n">coverage</span><span class="o">=</span><span class="n">coverage</span><span class="p">)</span>
    <span class="n">lo</span><span class="p">,</span> <span class="n">hi</span> <span class="o">=</span> <span class="n">ci</span>

    <span class="n">ndigits</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ndigits</span><span class="p">(</span><span class="n">ci</span><span class="o">=</span><span class="n">ci</span><span class="p">)</span>
    <span class="n">param_str</span> <span class="o">=</span> <span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span><span class="w"> </span><span class="n">ndigits</span><span class="p">)</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">lo</span><span class="p">,</span><span class="w"> </span><span class="n">ndigits</span><span class="p">)</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">hi</span><span class="p">,</span><span class="w"> </span><span class="n">ndigits</span><span class="p">)</span><span class="si">}</span><span class="s2">)&quot;</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="n">label</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">param_str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">label</span><span class="si">}</span><span class="s2">=</span><span class="si">{</span><span class="n">param_str</span><span class="si">}</span><span class="s2">&quot;</span>

    <span class="n">p</span> <span class="o">=</span> <span class="n">gaussian_kde</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">estimates</span><span class="p">)</span>

    <span class="n">x_grid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">estimates</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">estimates</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">n_grid</span><span class="p">)</span>
    <span class="n">within_ci</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logical_and</span><span class="p">(</span><span class="n">x_grid</span> <span class="o">&gt;=</span> <span class="n">lo</span><span class="p">,</span> <span class="n">x_grid</span> <span class="o">&lt;=</span> <span class="n">hi</span><span class="p">)</span>
    <span class="n">y_grid</span> <span class="o">=</span> <span class="n">p</span><span class="p">(</span><span class="n">x_grid</span><span class="p">)</span>
    <span class="n">y_mean</span> <span class="o">=</span> <span class="n">p</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">mean</span><span class="p">])</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>

    <span class="p">(</span><span class="n">line</span><span class="p">,)</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_grid</span><span class="p">,</span> <span class="n">y_grid</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">param_str</span><span class="p">)</span>
    <span class="n">color</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">get_color</span><span class="p">()</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span>
        <span class="n">x_grid</span><span class="p">[</span><span class="n">within_ci</span><span class="p">],</span>
        <span class="mi">0</span><span class="p">,</span>
        <span class="n">y_grid</span><span class="p">[</span><span class="n">within_ci</span><span class="p">],</span>
        <span class="n">facecolor</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
        <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">mean</span><span class="p">]</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">y_mean</span><span class="p">],</span> <span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">mean</span><span class="p">],</span> <span class="p">[</span><span class="n">y_mean</span><span class="p">],</span> <span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">fig</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Bayesian bootstrap    </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">n_boot</span><span class="si">}</span><span class="s2"> resamples, </span><span class="si">{</span><span class="n">coverage</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">100</span><span class="si">:</span><span class="s2">.0f</span><span class="si">}</span><span class="s2">% CI&quot;</span>
        <span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Distribution of estimates&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">ax</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>


<div class="doc doc-object doc-function">


<h2 id="bbstat.evaluate.credibility_interval" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">credibility_interval</span><span class="p">(</span><span class="n">estimates</span><span class="p">,</span> <span class="n">coverage</span><span class="o">=</span><span class="mf">0.87</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Compute the credibility interval for a set of estimates.</p>
<p>This function calculates the credibility interval of the given <code>estimates</code> array,
which is a range of values that contains a specified proportion of the data,
determined by the <code>coverage</code> parameter.</p>
<p>The credibility interval is calculated by determining the quantiles at
<code>(1 - coverage) / 2</code> and <code>1 - (1 - coverage) / 2</code> of the sorted <code>estimates</code> data.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>estimates</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="FArray = NDArray[np.floating]

  
      module-attribute
   (bbstat.statistics.FArray)" href="#bbstat.statistics.FArray">FArray</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A 1D array of floating-point numbers representing
the estimates from which the credibility interval will be calculated.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>coverage</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The proportion of data to be included in the credibility
interval. Must be between 0 and 1 (exclusive). Default is 0.87.</p>
              </div>
            </td>
            <td>
                  <code>0.87</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Tuple">Tuple</span>[<span title="float">float</span>, <span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Tuple[float, float]: A tuple containing the lower and upper bounds of the credibility
interval, with the lower bound corresponding to the <code>(1 - coverage) / 2</code> quantile,
and the upper bound corresponding to the <code>1 - (1 - coverage) / 2</code> quantile.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>estimates</code> is not a 1D array or if <code>coverage</code> is not between 0 and 1
(exclusive).</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <pre><code class="language-python">import numpy as np
estimates = np.array([1.1, 2.3, 3.5, 2.9, 4.0])
credibility_interval(estimates, 0.6)  # =&gt; (2.06, 3.6)
</code></pre>
</details>

            <details class="quote">
              <summary>Source code in <code>bbstat/evaluate.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">credibility_interval</span><span class="p">(</span>
    <span class="n">estimates</span><span class="p">:</span> <span class="n">FArray</span><span class="p">,</span>
    <span class="n">coverage</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.87</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute the credibility interval for a set of estimates.</span>

<span class="sd">    This function calculates the credibility interval of the given `estimates` array,</span>
<span class="sd">    which is a range of values that contains a specified proportion of the data,</span>
<span class="sd">    determined by the `coverage` parameter.</span>

<span class="sd">    The credibility interval is calculated by determining the quantiles at</span>
<span class="sd">    `(1 - coverage) / 2` and `1 - (1 - coverage) / 2` of the sorted `estimates` data.</span>

<span class="sd">    Args:</span>
<span class="sd">        estimates (FArray): A 1D array of floating-point numbers representing</span>
<span class="sd">            the estimates from which the credibility interval will be calculated.</span>
<span class="sd">        coverage (float, optional): The proportion of data to be included in the credibility</span>
<span class="sd">            interval. Must be between 0 and 1 (exclusive). Default is 0.87.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Tuple[float, float]: A tuple containing the lower and upper bounds of the credibility</span>
<span class="sd">            interval, with the lower bound corresponding to the `(1 - coverage) / 2` quantile,</span>
<span class="sd">            and the upper bound corresponding to the `1 - (1 - coverage) / 2` quantile.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If `estimates` is not a 1D array or if `coverage` is not between 0 and 1</span>
<span class="sd">            (exclusive).</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        import numpy as np</span>
<span class="sd">        estimates = np.array([1.1, 2.3, 3.5, 2.9, 4.0])</span>
<span class="sd">        credibility_interval(estimates, 0.6)  # =&gt; (2.06, 3.6)</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">estimates</span><span class="o">.</span><span class="n">ndim</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid parameter </span><span class="si">{</span><span class="n">estimates</span><span class="o">.</span><span class="n">ndim</span><span class="si">=:}</span><span class="s2">: must be 1D array.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">coverage</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">coverage</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid parameter </span><span class="si">{</span><span class="n">coverage</span><span class="si">=:}</span><span class="s2">: must be within (0, 1).&quot;</span><span class="p">)</span>
    <span class="n">edge</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">coverage</span><span class="p">)</span> <span class="o">/</span> <span class="mf">2.0</span>
    <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">estimates</span><span class="p">,</span> <span class="p">[</span><span class="n">edge</span><span class="p">,</span> <span class="mf">1.0</span> <span class="o">-</span> <span class="n">edge</span><span class="p">])</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><hr />
<h2 id="registry-module"><code>registry</code> Module</h2>


<div class="doc doc-object doc-module">



<a id="bbstat.registry"></a>
    <div class="doc doc-contents first">

        <p>Statistic function registry and protocol definition.</p>
<p>This module defines a strict <code>Protocol</code> (<code>StatisticFunction</code>) for all supported
statistical aggregation functions used in the system. It also provides a typed
mapping of statistic function names to their concrete implementations and a
lookup function (<code>get_statistic_fn</code>) for retrieving them by name.</p>
<p>All registered functions are callable with specific combinations of arguments
(e.g. <code>data</code>, <code>weights</code>, and optional parameters like <code>ddof</code>, <code>factor</code>, or
<code>sorter</code>) depending on the computation type. Static typing ensures correct
usage of each registered function.</p>










  <div class="doc doc-children">









<div class="doc doc-object doc-class">



<h2 id="bbstat.registry.StatisticFunction" class="doc doc-heading">
            <code>StatisticFunction</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="typing.Protocol">Protocol</span></code></p>


        <p>A protocol defining the interface for all statistical computation functions.</p>
<p>Each implementing function must take <code>data</code> and <code>weights</code> arrays and may
accept additional keyword-only arguments depending on the computation type.</p>
<p>Overloads:</p>
<ul>
<li><code>aggregate</code>: accepts <code>data: FArray</code>, <code>weights: FArray</code>, and optional <code>factor: float</code></li>
<li><code>mean</code>, <code>sum</code>: accept only <code>data: FArray</code>, <code>weights: FArray</code></li>
<li><code>variance</code>, <code>std</code>: accept optional <code>weighted_mean: float</code> and <code>ddof: int</code></li>
<li><code>quantile</code>: requires <code>quantile: float</code> and optional <code>sorter: IArray</code></li>
<li><code>percentile</code>: requires <code>percentile: float</code> and optional <code>sorter: IArray</code></li>
<li><code>median</code>: accepts optional <code>sorter</code></li>
<li><code>mutual_information</code>: accepts <code>data: IIArray</code> and <code>weights: FArray</code>, and <code>normalize: bool = True</code></li>
<li><code>pearson_dependency</code>, <code>spearman_dependency</code>: take tuple of two
  float arrays (<code>FFArray</code>) and <code>ddof</code></li>
<li><code>eta_square_dependency</code>: takes tuple of and integer and a float
  array (<code>IFArray</code>)</li>
<li><code>entropy</code>: accepts <code>data: IFArray</code> and <code>weights: FArray</code></li>
<li><code>probability</code>, <code>self_information</code>, <code>log_odds</code>: accepts <code>data: IFArray</code>,
  <code>weights: FArray</code>, and <code>state: int</code></li>
</ul>








              <details class="quote">
                <summary>Source code in <code>bbstat/registry.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">StatisticFunction</span><span class="p">(</span><span class="n">Protocol</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A protocol defining the interface for all statistical computation functions.</span>

<span class="sd">    Each implementing function must take `data` and `weights` arrays and may</span>
<span class="sd">    accept additional keyword-only arguments depending on the computation type.</span>

<span class="sd">    Overloads:</span>

<span class="sd">    - `aggregate`: accepts `data: FArray`, `weights: FArray`, and optional `factor: float`</span>
<span class="sd">    - `mean`, `sum`: accept only `data: FArray`, `weights: FArray`</span>
<span class="sd">    - `variance`, `std`: accept optional `weighted_mean: float` and `ddof: int`</span>
<span class="sd">    - `quantile`: requires `quantile: float` and optional `sorter: IArray`</span>
<span class="sd">    - `percentile`: requires `percentile: float` and optional `sorter: IArray`</span>
<span class="sd">    - `median`: accepts optional `sorter`</span>
<span class="sd">    - `mutual_information`: accepts `data: IIArray` and `weights: FArray`, and `normalize: bool = True`</span>
<span class="sd">    - `pearson_dependency`, `spearman_dependency`: take tuple of two</span>
<span class="sd">      float arrays (`FFArray`) and `ddof`</span>
<span class="sd">    - `eta_square_dependency`: takes tuple of and integer and a float</span>
<span class="sd">      array (`IFArray`)</span>
<span class="sd">    - `entropy`: accepts `data: IFArray` and `weights: FArray`</span>
<span class="sd">    - `probability`, `self_information`, `log_odds`: accepts `data: IFArray`,</span>
<span class="sd">      `weights: FArray`, and `state: int`</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># aggregate</span>
    <span class="nd">@overload</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">data</span><span class="p">:</span> <span class="n">FArray</span><span class="p">,</span>
        <span class="n">weights</span><span class="p">:</span> <span class="n">FArray</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">factor</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span> <span class="o">...</span>

    <span class="c1"># mean, sum</span>
    <span class="nd">@overload</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">data</span><span class="p">:</span> <span class="n">FArray</span><span class="p">,</span>
        <span class="n">weights</span><span class="p">:</span> <span class="n">FArray</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span> <span class="o">...</span>

    <span class="c1"># entropy</span>
    <span class="nd">@overload</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">data</span><span class="p">:</span> <span class="n">IArray</span><span class="p">,</span>
        <span class="n">weights</span><span class="p">:</span> <span class="n">FArray</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span> <span class="o">...</span>

    <span class="c1"># mutual_information</span>
    <span class="nd">@overload</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">data</span><span class="p">:</span> <span class="n">IIArray</span><span class="p">,</span>
        <span class="n">weights</span><span class="p">:</span> <span class="n">FArray</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">normalize</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span> <span class="o">...</span>

    <span class="c1"># probability, log_odds, self_information</span>
    <span class="nd">@overload</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">data</span><span class="p">:</span> <span class="n">IArray</span><span class="p">,</span>
        <span class="n">weights</span><span class="p">:</span> <span class="n">FArray</span><span class="p">,</span>
        <span class="n">state</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span> <span class="o">...</span>

    <span class="c1"># variance, std</span>
    <span class="nd">@overload</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">data</span><span class="p">:</span> <span class="n">FArray</span><span class="p">,</span>
        <span class="n">weights</span><span class="p">:</span> <span class="n">FArray</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">weighted_mean</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span>
        <span class="n">ddof</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span> <span class="o">...</span>

    <span class="c1"># quantile</span>
    <span class="nd">@overload</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">data</span><span class="p">:</span> <span class="n">FArray</span><span class="p">,</span>
        <span class="n">weights</span><span class="p">:</span> <span class="n">FArray</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">quantile</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">sorter</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">IArray</span><span class="p">],</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span> <span class="o">...</span>

    <span class="c1"># percentile</span>
    <span class="nd">@overload</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">data</span><span class="p">:</span> <span class="n">FArray</span><span class="p">,</span>
        <span class="n">weights</span><span class="p">:</span> <span class="n">FArray</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">percentile</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">sorter</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">IArray</span><span class="p">],</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span> <span class="o">...</span>

    <span class="c1"># median</span>
    <span class="nd">@overload</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">data</span><span class="p">:</span> <span class="n">FArray</span><span class="p">,</span>
        <span class="n">weights</span><span class="p">:</span> <span class="n">FArray</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">sorter</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">IArray</span><span class="p">],</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span> <span class="o">...</span>

    <span class="c1"># pearson_dependency, spearman_dependency</span>
    <span class="nd">@overload</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">data</span><span class="p">:</span> <span class="n">FFArray</span><span class="p">,</span>
        <span class="n">weights</span><span class="p">:</span> <span class="n">FArray</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">ddof</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span> <span class="o">...</span>

    <span class="c1"># eta_squared_dependency</span>
    <span class="nd">@overload</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">data</span><span class="p">:</span> <span class="n">IFArray</span><span class="p">,</span>
        <span class="n">weights</span><span class="p">:</span> <span class="n">FArray</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span> <span class="o">...</span>
</code></pre></div></td></tr></table></div>
              </details>

    </div>

</div>


<div class="doc doc-object doc-function">


<h2 id="bbstat.registry.get_statistic_fn" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_statistic_fn</span><span class="p">(</span><span class="n">name</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Retrieve a registered statistic function by name.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The lowercase name of the statistic function to retrieve.
Must be one of:
- "aggregate"
- "entropy"
- "eta_square_dependency"
- "log_odds"
- "mean"
- "median"
- "mutual_information"
- "pearson_dependency"
- "percentile"
- "probability"
- "quantile"
- "self_information"
- "spearman_dependency"
- "std"
- "sum"
- "variance"</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>StatisticFunction</code></td>            <td>
                  <code><a class="autorefs autorefs-internal" title="StatisticFunction (bbstat.registry.StatisticFunction)" href="#bbstat.registry.StatisticFunction">StatisticFunction</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The corresponding function implementation.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the name does not correspond to a registered function.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>bbstat/registry.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_statistic_fn</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">StatisticFunction</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Retrieve a registered statistic function by name.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        name (str): The lowercase name of the statistic function to retrieve.</span>
<span class="sd">            Must be one of:</span>
<span class="sd">            - &quot;aggregate&quot;</span>
<span class="sd">            - &quot;entropy&quot;</span>
<span class="sd">            - &quot;eta_square_dependency&quot;</span>
<span class="sd">            - &quot;log_odds&quot;</span>
<span class="sd">            - &quot;mean&quot;</span>
<span class="sd">            - &quot;median&quot;</span>
<span class="sd">            - &quot;mutual_information&quot;</span>
<span class="sd">            - &quot;pearson_dependency&quot;</span>
<span class="sd">            - &quot;percentile&quot;</span>
<span class="sd">            - &quot;probability&quot;</span>
<span class="sd">            - &quot;quantile&quot;</span>
<span class="sd">            - &quot;self_information&quot;</span>
<span class="sd">            - &quot;spearman_dependency&quot;</span>
<span class="sd">            - &quot;std&quot;</span>
<span class="sd">            - &quot;sum&quot;</span>
<span class="sd">            - &quot;variance&quot;</span>

<span class="sd">    Returns:</span>
<span class="sd">        StatisticFunction: The corresponding function implementation.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If the name does not correspond to a registered function.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">STATISTIC_FUNCTIONS</span><span class="p">[</span><span class="n">name</span><span class="o">.</span><span class="n">lower</span><span class="p">()]</span>
    <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Invalid </span><span class="si">{</span><span class="n">name</span><span class="si">=:}</span><span class="s2">: choose from </span><span class="si">{</span><span class="nb">list</span><span class="p">(</span><span class="n">STATISTIC_FUNCTIONS</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="bbstat.registry.get_statistic_fn_names" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_statistic_fn_names</span><span class="p">()</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Retrieve the names of registered statistic functions.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Tuple">Tuple</span>[<span title="str">str</span>, ...]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Tuple[str, ...]: The names of the available statistic functions.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>bbstat/registry.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_statistic_fn_names</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="o">...</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Retrieve the names of registered statistic functions.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Tuple[str, ...]: The names of the available statistic functions.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">STATISTIC_FUNCTIONS</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><hr />
<h2 id="resample-module"><code>resample</code> Module</h2>


<div class="doc doc-object doc-module">



<a id="bbstat.resample"></a>
    <div class="doc doc-contents first">

        <p>Bootstrap resampling utilities using Dirichlet-distributed weights.</p>
<p>This module provides functionality for generating bootstrap resamples via the Bayesian
bootstrap method, where resamples are weighted using samples from a Dirichlet distribution.
It is intended for internal use within higher-level resampling and estimation workflows.</p>
<p>The function <code>resample</code> yields weighted resamples suitable for estimating
statistics under uncertainty without making parametric assumptions.</p>


<details class="main-features" open>
  <summary>Main Features</summary>
  <ul>
<li>Dirichlet-based resampling for Bayesian bootstrap.</li>
<li>Support for blockwise resample generation to control memory usage.</li>
<li>Optional random seed for reproducibility.</li>
<li>Generator interface for efficient streaming of resample weights.</li>
</ul>
</details>

<details class="example" open>
  <summary>Example</summary>
  <pre><code class="language-python">from bbstat.resample import resample
for weights in resample(n_boot=1000, n_data=50):
    # Apply weights to compute statistic
    ...
</code></pre>
</details>

<details class="notes" open>
  <summary>Notes</summary>
  <ul>
<li>The function is designed to scale to large numbers of resamples.</li>
<li>It is most useful as a low-level utility within a bootstrap framework.</li>
</ul>
</details>        <p>See the <code>resample</code> function docstring for complete usage details.</p>










  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h2 id="bbstat.resample.resample" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">resample</span><span class="p">(</span><span class="n">n_boot</span><span class="p">,</span> <span class="n">n_data</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">blocksize</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Generates bootstrap resamples with Dirichlet-distributed weights.</p>
<p>This function performs resampling by generating weights from a Dirichlet distribution.
The number of resamples is controlled by the <code>n_boot</code> argument, while the size of
each block of resamples can be adjusted using the <code>blocksize</code> argument. The <code>seed</code>
argument allows for reproducible results.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>n_boot</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The total number of bootstrap resamples to generate.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>n_data</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The number of data points to resample (used for the dimension of the
Dirichlet distribution).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>seed</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A random seed for reproducibility (default is <code>None</code> for
random seeding).</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>blocksize</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The number of resamples to generate in each block.
If <code>None</code>, the entire number of resamples is generated in one block.
Defaults to <code>None</code>.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Yields:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="FArray = NDArray[np.floating]

  
      module-attribute
   (bbstat.statistics.FArray)" href="#bbstat.statistics.FArray">FArray</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Generator[FArray, None, None]: A generator that yields each resample
(a 1D array of floats) as it is generated. Each resample contains Dirichlet-
distributed weights for the given <code>n_data</code>.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <pre><code class="language-python">for r in resample(n_boot=10, n_data=5):
    print(r)
</code></pre>
</details>

<details class="notes" open>
  <summary>Notes</summary>
  <ul>
<li>If <code>blocksize</code> is specified, the resampling will be performed in smaller blocks,
  which can be useful for parallelizing or limiting memory usage.</li>
<li>The function uses NumPy's <code>default_rng</code> to generate random numbers, which provides
  a more flexible and efficient interface compared to <code>np.random.seed</code>.</li>
</ul>
</details>

<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>n_boot</code> is less than 1 or <code>n_data</code> is less than 1.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>bbstat/resample.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">resample</span><span class="p">(</span>
    <span class="n">n_boot</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">n_data</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">seed</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">blocksize</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Generator</span><span class="p">[</span><span class="n">FArray</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generates bootstrap resamples with Dirichlet-distributed weights.</span>

<span class="sd">    This function performs resampling by generating weights from a Dirichlet distribution.</span>
<span class="sd">    The number of resamples is controlled by the `n_boot` argument, while the size of</span>
<span class="sd">    each block of resamples can be adjusted using the `blocksize` argument. The `seed`</span>
<span class="sd">    argument allows for reproducible results.</span>

<span class="sd">    Args:</span>
<span class="sd">        n_boot (int): The total number of bootstrap resamples to generate.</span>
<span class="sd">        n_data (int): The number of data points to resample (used for the dimension of the</span>
<span class="sd">            Dirichlet distribution).</span>
<span class="sd">        seed (int, optional): A random seed for reproducibility (default is `None` for</span>
<span class="sd">            random seeding).</span>
<span class="sd">        blocksize (int, optional): The number of resamples to generate in each block.</span>
<span class="sd">            If `None`, the entire number of resamples is generated in one block.</span>
<span class="sd">            Defaults to `None`.</span>

<span class="sd">    Yields:</span>
<span class="sd">        Generator[FArray, None, None]: A generator that yields each resample</span>
<span class="sd">            (a 1D array of floats) as it is generated. Each resample contains Dirichlet-</span>
<span class="sd">            distributed weights for the given `n_data`.</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        for r in resample(n_boot=10, n_data=5):</span>
<span class="sd">            print(r)</span>
<span class="sd">        ```</span>

<span class="sd">    Notes:</span>
<span class="sd">        - If `blocksize` is specified, the resampling will be performed in smaller blocks,</span>
<span class="sd">          which can be useful for parallelizing or limiting memory usage.</span>
<span class="sd">        - The function uses NumPy&#39;s `default_rng` to generate random numbers, which provides</span>
<span class="sd">          a more flexible and efficient interface compared to `np.random.seed`.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If `n_boot` is less than 1 or `n_data` is less than 1.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">n_boot</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid parameter </span><span class="si">{</span><span class="n">n_boot</span><span class="si">=:}</span><span class="s2">: must be positive.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">n_data</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid parameter </span><span class="si">{</span><span class="n">n_data</span><span class="si">=:}</span><span class="s2">: must be positive.&quot;</span><span class="p">)</span>
    <span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
    <span class="n">alpha</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n_data</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">blocksize</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">blocksize</span> <span class="o">=</span> <span class="n">n_boot</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">blocksize</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">blocksize</span><span class="p">),</span> <span class="n">n_boot</span><span class="p">)</span>
    <span class="n">remainder</span> <span class="o">=</span> <span class="n">n_boot</span>
    <span class="k">while</span> <span class="n">remainder</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">size</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">blocksize</span><span class="p">,</span> <span class="n">remainder</span><span class="p">)</span>
        <span class="n">weights</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">dirichlet</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">weights</span><span class="p">:</span>
            <span class="k">yield</span> <span class="n">w</span>
        <span class="n">remainder</span> <span class="o">-=</span> <span class="n">size</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><hr />
<h2 id="statistics-module"><code>statistics</code> Module</h2>


<div class="doc doc-object doc-module">



<a id="bbstat.statistics"></a>
    <div class="doc doc-contents first">

        <p>Type definitions and weighted statistical functions for use in bootstrap resampling and analysis.</p>
<p>This module defines types for statistical functions that operate on weighted data,
particularly in the context of Bayesian bootstrap procedures. It provides a collection
of pre-defined weighted statistics (e.g., mean, variance, quantile).</p>


<details class="main-features" open>
  <summary>Main Features</summary>
  <ul>
<li>Type aliases for data and weights.</li>
<li>A library of built-in weighted statistical functions (e.g., mean, std, quantile, etc.)</li>
</ul>
</details>

<p><span class="doc-section-title">Type Aliases:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="bbstat.statistics.- `FArray`">- `FArray`</span></code></td>
            <td>
              <div class="doc-md-description">
                <p>Alias for <code>numpy.typing.NDArray[numpy.floating]</code>, used for floating-point data and weights.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="bbstat.statistics.- `IArray`">- `IArray`</span></code></td>
            <td>
              <div class="doc-md-description">
                <p>Alias for <code>numpy.typing.NDArray[numpy.integer]</code>, used for index arrays.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="bbstat.statistics.- `FFArray`, `IFArray`, `IIArray`">- `FFArray`, `IFArray`, `IIArray`</span></code></td>
            <td>
              <div class="doc-md-description">
                <p>Tuples of data arrays used in bivariate computations.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="built-in-functions" open>
  <summary>Built-in Functions</summary>
  <ul>
<li><code>"compute_weighted_aggregate"</code>: Weighted dot product, optionally scaled by a factor (internal use only).</li>
<li><code>"compute_weighted_entropy"</code>: Weighted entropy.</li>
<li><code>"compute_weighted_eta_square_dependency"</code>: Effect size for categorical-continuous variable relationships.</li>
<li><code>"compute_weighted_mean"</code>: Weighted arithmetic mean.</li>
<li><code>"compute_weighted_median"</code>: Weighted median.</li>
<li><code>"compute_weighted_mutual_information"</code>: Weighted mutual information.</li>
<li><code>"compute_weighted_pearson_dependency"</code>: Weighted Pearson correlation for two variables.</li>
<li><code>"compute_weighted_probability"</code>: Weighted probability of a state.</li>
<li><code>"compute_weighted_quantile"</code> / <code>"compute_weighted_percentile"</code>: Weighted quantile estimation.</li>
<li><code>"compute_weighted_spearman_dependency"</code>: Weighted Spearman correlation.</li>
<li><code>"compute_weighted_std"</code>: Weighted standard deviation.</li>
<li><code>"compute_weighted_sum"</code>: Weighted sum.</li>
<li><code>"compute_weighted_variance"</code>: Weighted variance with optional degrees of freedom correction.</li>
</ul>
</details>

<details class="notes" open>
  <summary>Notes</summary>
  <ul>
<li>All functions assume normalized weights (i.e., sum to 1).</li>
<li>Functions raise <code>ValueError</code> for invalid shapes, mismatched dimensions, or inappropriate input types.</li>
<li>This module is intended for use with <code>bootstrap</code>, which applies these functions across bootstrap resamples.</li>
</ul>
</details>









  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h2 id="bbstat.statistics.FArray" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">FArray</span> <span class="o">=</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">floating</span><span class="p">]</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h2>


    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="bbstat.statistics.FFArray" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">FFArray</span> <span class="o">=</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">FArray</span><span class="p">,</span> <span class="n">FArray</span><span class="p">]</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h2>


    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="bbstat.statistics.IArray" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">IArray</span> <span class="o">=</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">integer</span><span class="p">]</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h2>


    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="bbstat.statistics.IFArray" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">IFArray</span> <span class="o">=</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">IArray</span><span class="p">,</span> <span class="n">FArray</span><span class="p">]</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h2>


    <div class="doc doc-contents ">

    </div>

</div>




<div class="doc doc-object doc-function">


<h2 id="bbstat.statistics.compute_weighted_aggregate" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">compute_weighted_aggregate</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">weights</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">factor</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Computes a weighted aggregate of the input data.</p>
<p>This function calculates the dot product of the input <code>data</code> and <code>weights</code>.
The function assumes that both <code>data</code> and <code>weights</code> are 1D arrays of the same
length and that the weights sum to 1. If a <code>factor</code> is provided, the dot product
is multiplied with it.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>data</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="FArray = NDArray[np.floating]

  
      module-attribute
   (bbstat.statistics.FArray)" href="#bbstat.statistics.FArray">FArray</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A 1D array of numeric values representing the
data to be aggregated.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>weights</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="FArray = NDArray[np.floating]

  
      module-attribute
   (bbstat.statistics.FArray)" href="#bbstat.statistics.FArray">FArray</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A 1D array of numeric values representing
the weights for the data.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>factor</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A scalar factor to multiply with the computed
aggregate (default is None).</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>float</code></td>            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The computed weighted aggregate, potentially scaled by the <code>factor</code>.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>data</code> or <code>weights</code> are not 1D arrays.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the shapes of <code>data</code> and <code>weights</code> do not match.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <pre><code class="language-python">data = np.array([1.0, 2.0, 3.0])
weights = np.array([0.2, 0.5, 0.3])
print(compute_weighted_aggregate(data, weights))  # =&gt; 2.1
print(compute_weighted_aggregate(data, weights, factor=1.5))  # =&gt; 3.15
</code></pre>
</details>

<details class="notes" open>
  <summary>Notes</summary>
  <p>The weighted aggregate is computed using the dot product between <code>data</code> and <code>weights</code>.
The optional <code>factor</code> scales the result of this dot product. If no factor is given,
the aggregation computes the weighted arithmetic mean of the data; if instead the factor
equals the length of the data array, the aggregation computes the weighted sum.</p>
</details>

            <details class="quote">
              <summary>Source code in <code>bbstat/statistics.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">compute_weighted_aggregate</span><span class="p">(</span>
    <span class="n">data</span><span class="p">:</span> <span class="n">FArray</span><span class="p">,</span>
    <span class="n">weights</span><span class="p">:</span> <span class="n">FArray</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">factor</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Computes a weighted aggregate of the input data.</span>

<span class="sd">    This function calculates the dot product of the input `data` and `weights`.</span>
<span class="sd">    The function assumes that both `data` and `weights` are 1D arrays of the same</span>
<span class="sd">    length and that the weights sum to 1. If a `factor` is provided, the dot product</span>
<span class="sd">    is multiplied with it.</span>

<span class="sd">    Args:</span>
<span class="sd">        data (FArray): A 1D array of numeric values representing the</span>
<span class="sd">            data to be aggregated.</span>
<span class="sd">        weights (FArray): A 1D array of numeric values representing</span>
<span class="sd">            the weights for the data.</span>
<span class="sd">        factor (float, optional): A scalar factor to multiply with the computed</span>
<span class="sd">            aggregate (default is None).</span>

<span class="sd">    Returns:</span>
<span class="sd">        float: The computed weighted aggregate, potentially scaled by the `factor`.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If `data` or `weights` are not 1D arrays.</span>
<span class="sd">        ValueError: If the shapes of `data` and `weights` do not match.</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        data = np.array([1.0, 2.0, 3.0])</span>
<span class="sd">        weights = np.array([0.2, 0.5, 0.3])</span>
<span class="sd">        print(compute_weighted_aggregate(data, weights))  # =&gt; 2.1</span>
<span class="sd">        print(compute_weighted_aggregate(data, weights, factor=1.5))  # =&gt; 3.15</span>
<span class="sd">        ```</span>

<span class="sd">    Notes:</span>
<span class="sd">        The weighted aggregate is computed using the dot product between `data` and `weights`.</span>
<span class="sd">        The optional `factor` scales the result of this dot product. If no factor is given,</span>
<span class="sd">        the aggregation computes the weighted arithmetic mean of the data; if instead the factor</span>
<span class="sd">        equals the length of the data array, the aggregation computes the weighted sum.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">validate_array</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="n">weights</span><span class="p">)</span>
    <span class="n">aggregate</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">weights</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">factor</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">aggregate</span> <span class="o">*=</span> <span class="n">factor</span>
    <span class="k">return</span> <span class="n">aggregate</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="bbstat.statistics.compute_weighted_entropy" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">compute_weighted_entropy</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">weights</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Computes a weighted entropy of 1D code data.</p>
<p>This function calculates the weighted entropy by first computing
the weighted distribution, dropping the zero elements (contribute
zero to the following sum), and computing the negative dot product
between the distribution and log-distribution.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>data</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="IArray = NDArray[np.integer]

  
      module-attribute
   (bbstat.statistics.IArray)" href="#bbstat.statistics.IArray">IArray</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A 1D array of numeric values representing
the sample data in code format.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>weights</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="FArray = NDArray[np.floating]

  
      module-attribute
   (bbstat.statistics.FArray)" href="#bbstat.statistics.FArray">FArray</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A 1D array of numeric weights corresponding
to the data.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>float</code></td>            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The weighted entropy value.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>data</code> and <code>weights</code> have different shapes or are not 1D.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <pre><code class="language-python">data = np.array([1, 0, 0])
weights = np.array([0.4, 0.2, 0.4])
print(compute_weighted_entropy(data, weights))  # =&gt; 0.673...
</code></pre>
</details>

            <details class="quote">
              <summary>Source code in <code>bbstat/statistics.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">compute_weighted_entropy</span><span class="p">(</span>
    <span class="n">data</span><span class="p">:</span> <span class="n">IArray</span><span class="p">,</span>
    <span class="n">weights</span><span class="p">:</span> <span class="n">FArray</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Computes a weighted entropy of 1D code data.</span>

<span class="sd">    This function calculates the weighted entropy by first computing</span>
<span class="sd">    the weighted distribution, dropping the zero elements (contribute</span>
<span class="sd">    zero to the following sum), and computing the negative dot product</span>
<span class="sd">    between the distribution and log-distribution.</span>

<span class="sd">    Args:</span>
<span class="sd">        data (IArray): A 1D array of numeric values representing</span>
<span class="sd">            the sample data in code format.</span>
<span class="sd">        weights (FArray): A 1D array of numeric weights corresponding</span>
<span class="sd">            to the data.</span>

<span class="sd">    Returns:</span>
<span class="sd">        float: The weighted entropy value.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If `data` and `weights` have different shapes or are not 1D.</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        data = np.array([1, 0, 0])</span>
<span class="sd">        weights = np.array([0.4, 0.2, 0.4])</span>
<span class="sd">        print(compute_weighted_entropy(data, weights))  # =&gt; 0.673...</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">validate_array</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="n">weights</span><span class="p">)</span>
    <span class="n">active_set</span> <span class="o">=</span> <span class="n">get_active_set</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
    <span class="n">distribution</span> <span class="o">=</span> <span class="n">weighted_discrete_distribution</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">active_set</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="n">weights</span><span class="p">)</span>
    <span class="n">distribution</span> <span class="o">=</span> <span class="n">distribution</span><span class="p">[</span><span class="n">distribution</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">]</span>
    <span class="k">return</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">distribution</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">distribution</span><span class="p">))</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="bbstat.statistics.compute_weighted_eta_square_dependency" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">compute_weighted_eta_square_dependency</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">weights</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Computes the weighted eta-squared () statistic to assess dependency between
a categorical and a numerical variable.</p>
<p>Eta-squared measures the proportion of total variance in the numerical variable
that is explained by the categorical grouping. It is commonly used in ANOVA-like
analyses and effect size estimation. The value is bounded between 0 and 1.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>data</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="IFArray = Tuple[IArray, FArray]

  
      module-attribute
   (bbstat.statistics.IFArray)" href="#bbstat.statistics.IFArray">IFArray</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A tuple <code>(data_cat, data_num)</code> where:
- <code>data_cat</code> is a 1D array of integer-encoded categorical values.
- <code>data_num</code> is a 1D array of corresponding numeric values.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>weights</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="FArray = NDArray[np.floating]

  
      module-attribute
   (bbstat.statistics.FArray)" href="#bbstat.statistics.FArray">FArray</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A 1D array of non-negative weights,
same length as <code>data_cat</code>.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>float</code></td>            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Weighted eta-squared value in the range [0, 1], where higher values</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td></td>            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>indicate stronger association between the categorical and numeric variable.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If input arrays are not 1D or do not have matching shapes.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <pre><code class="language-python">data_cat = np.array([0, 0, 1, 1])
data_num = np.array([1.0, 2.0, 3.0, 4.0])
weights = np.array([0.25, 0.25, 0.25, 0.25)
print(compute_weighted_eta_square_dependency((data_cat, data_num), weights))  # =&gt; 0.8
</code></pre>
</details>

<details class="notes" open>
  <summary>Notes</summary>
  <ul>
<li>Internally,  is computed as the ratio of weighted between-group variance
  to the total weighted variance.</li>
<li>The statistic is sensitive to group sizes and imbalance in weights.</li>
<li>When all group means equal the global mean,  is 0.</li>
<li>When groups are perfectly separated by the numeric variable,  is 1.</li>
</ul>
</details>

            <details class="quote">
              <summary>Source code in <code>bbstat/statistics.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">compute_weighted_eta_square_dependency</span><span class="p">(</span>
    <span class="n">data</span><span class="p">:</span> <span class="n">IFArray</span><span class="p">,</span>
    <span class="n">weights</span><span class="p">:</span> <span class="n">FArray</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Computes the weighted eta-squared () statistic to assess dependency between</span>
<span class="sd">    a categorical and a numerical variable.</span>

<span class="sd">    Eta-squared measures the proportion of total variance in the numerical variable</span>
<span class="sd">    that is explained by the categorical grouping. It is commonly used in ANOVA-like</span>
<span class="sd">    analyses and effect size estimation. The value is bounded between 0 and 1.</span>

<span class="sd">    Args:</span>
<span class="sd">        data (IFArray): A tuple `(data_cat, data_num)` where:</span>
<span class="sd">            - `data_cat` is a 1D array of integer-encoded categorical values.</span>
<span class="sd">            - `data_num` is a 1D array of corresponding numeric values.</span>
<span class="sd">        weights (FArray): A 1D array of non-negative weights,</span>
<span class="sd">            same length as `data_cat`.</span>

<span class="sd">    Returns:</span>
<span class="sd">        float: Weighted eta-squared value in the range [0, 1], where higher values</span>
<span class="sd">        indicate stronger association between the categorical and numeric variable.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If input arrays are not 1D or do not have matching shapes.</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        data_cat = np.array([0, 0, 1, 1])</span>
<span class="sd">        data_num = np.array([1.0, 2.0, 3.0, 4.0])</span>
<span class="sd">        weights = np.array([0.25, 0.25, 0.25, 0.25)</span>
<span class="sd">        print(compute_weighted_eta_square_dependency((data_cat, data_num), weights))  # =&gt; 0.8</span>
<span class="sd">        ```</span>

<span class="sd">    Notes:</span>
<span class="sd">        - Internally,  is computed as the ratio of weighted between-group variance</span>
<span class="sd">          to the total weighted variance.</span>
<span class="sd">        - The statistic is sensitive to group sizes and imbalance in weights.</span>
<span class="sd">        - When all group means equal the global mean,  is 0.</span>
<span class="sd">        - When groups are perfectly separated by the numeric variable,  is 1.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_cat</span><span class="p">,</span> <span class="n">data_num</span> <span class="o">=</span> <span class="n">data</span>
    <span class="n">mean_sample</span> <span class="o">=</span> <span class="n">compute_weighted_mean</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data_num</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="n">weights</span><span class="p">)</span>
    <span class="n">group_variance_sum</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">data_cat</span><span class="p">):</span>
        <span class="n">subset</span> <span class="o">=</span> <span class="n">data_cat</span> <span class="o">==</span> <span class="n">value</span>
        <span class="n">group_weight</span> <span class="o">=</span> <span class="n">weights</span><span class="p">[</span><span class="n">subset</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
        <span class="n">mean_group</span> <span class="o">=</span> <span class="n">compute_weighted_aggregate</span><span class="p">(</span>
            <span class="n">data</span><span class="o">=</span><span class="n">data_num</span><span class="p">[</span><span class="n">subset</span><span class="p">],</span>
            <span class="n">weights</span><span class="o">=</span><span class="n">weights</span><span class="p">[</span><span class="n">subset</span><span class="p">],</span>
            <span class="n">factor</span><span class="o">=</span><span class="mf">1.0</span> <span class="o">/</span> <span class="n">group_weight</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">group_variance_sum</span> <span class="o">+=</span> <span class="n">group_weight</span> <span class="o">*</span> <span class="p">(</span><span class="n">mean_group</span> <span class="o">-</span> <span class="n">mean_sample</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span>
    <span class="k">return</span> <span class="n">group_variance_sum</span> <span class="o">/</span> <span class="n">compute_weighted_variance</span><span class="p">(</span>
        <span class="n">data</span><span class="o">=</span><span class="n">data_num</span><span class="p">,</span>
        <span class="n">weights</span><span class="o">=</span><span class="n">weights</span><span class="p">,</span>
        <span class="n">ddof</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="bbstat.statistics.compute_weighted_log_odds" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">compute_weighted_log_odds</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">weights</span><span class="p">,</span> <span class="n">state</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Computes a weighted log-odds of a state within 1D code data.</p>
<p>This function calculates the weighted probability of a <code>state</code>, <code>p(state)</code> by summing
the <code>weights</code> which coincide with <code>data == state</code>. The log-odds then
computes as logarithm of the odds <code>p(state) / (1 - p(state))</code>.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>data</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="IArray = NDArray[np.integer]

  
      module-attribute
   (bbstat.statistics.IArray)" href="#bbstat.statistics.IArray">IArray</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A 1D array of numeric values representing
the sample data in code format.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>weights</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="FArray = NDArray[np.floating]

  
      module-attribute
   (bbstat.statistics.FArray)" href="#bbstat.statistics.FArray">FArray</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A 1D array of numeric weights corresponding
to the data.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>state</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The state for which we estimate the log-odds.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>float</code></td>            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The weighted log-odds value.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>data</code> and <code>weights</code> have different shapes or are not 1D,
or if <code>state</code> is not in <code>data</code>.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <pre><code class="language-python">data = np.array([1, 0, 0])
weights = np.array([0.4, 0.2, 0.4])
print(compute_weighted_log_odds(data, weights, state=0))  # =&gt; 0.405...
</code></pre>
</details>

            <details class="quote">
              <summary>Source code in <code>bbstat/statistics.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">compute_weighted_log_odds</span><span class="p">(</span>
    <span class="n">data</span><span class="p">:</span> <span class="n">IArray</span><span class="p">,</span>
    <span class="n">weights</span><span class="p">:</span> <span class="n">FArray</span><span class="p">,</span>
    <span class="n">state</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Computes a weighted log-odds of a state within 1D code data.</span>

<span class="sd">    This function calculates the weighted probability of a `state`, `p(state)` by summing</span>
<span class="sd">    the `weights` which coincide with `data == state`. The log-odds then</span>
<span class="sd">    computes as logarithm of the odds `p(state) / (1 - p(state))`.</span>

<span class="sd">    Args:</span>
<span class="sd">        data (IArray): A 1D array of numeric values representing</span>
<span class="sd">            the sample data in code format.</span>
<span class="sd">        weights (FArray): A 1D array of numeric weights corresponding</span>
<span class="sd">            to the data.</span>
<span class="sd">        state (int): The state for which we estimate the log-odds.</span>

<span class="sd">    Returns:</span>
<span class="sd">        float: The weighted log-odds value.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If `data` and `weights` have different shapes or are not 1D,</span>
<span class="sd">            or if `state` is not in `data`.</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        data = np.array([1, 0, 0])</span>
<span class="sd">        weights = np.array([0.4, 0.2, 0.4])</span>
<span class="sd">        print(compute_weighted_log_odds(data, weights, state=0))  # =&gt; 0.405...</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">probability</span> <span class="o">=</span> <span class="n">compute_weighted_probability</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="n">weights</span><span class="p">,</span> <span class="n">state</span><span class="o">=</span><span class="n">state</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">probability</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">probability</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="bbstat.statistics.compute_weighted_mean" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">compute_weighted_mean</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">weights</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Computes a weighted mean of the input data.</p>
<p>This function calculates the weighted arithmetic mean of the input <code>data</code>
and <code>weights</code> via the <code>compute_weighted_aggregate</code> function.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>data</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="FArray = NDArray[np.floating]

  
      module-attribute
   (bbstat.statistics.FArray)" href="#bbstat.statistics.FArray">FArray</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A 1D array of numeric values representing
the data to be averaged.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>weights</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="FArray = NDArray[np.floating]

  
      module-attribute
   (bbstat.statistics.FArray)" href="#bbstat.statistics.FArray">FArray</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A 1D array of numeric values representing
the weights for the data.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>float</code></td>            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The computed weighted mean.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>data</code> or <code>weights</code> are not 1D arrays.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the shapes of <code>data</code> and <code>weights</code> do not match.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <pre><code class="language-python">data = np.array([1.0, 2.0, 3.0])
weights = np.array([0.2, 0.5, 0.3])
print(compute_weighted_mean(data, weights))  # =&gt; 2.1
</code></pre>
</details>

            <details class="quote">
              <summary>Source code in <code>bbstat/statistics.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">compute_weighted_mean</span><span class="p">(</span>
    <span class="n">data</span><span class="p">:</span> <span class="n">FArray</span><span class="p">,</span>
    <span class="n">weights</span><span class="p">:</span> <span class="n">FArray</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Computes a weighted mean of the input data.</span>

<span class="sd">    This function calculates the weighted arithmetic mean of the input `data`</span>
<span class="sd">    and `weights` via the `compute_weighted_aggregate` function.</span>

<span class="sd">    Args:</span>
<span class="sd">        data (FArray): A 1D array of numeric values representing</span>
<span class="sd">            the data to be averaged.</span>
<span class="sd">        weights (FArray): A 1D array of numeric values representing</span>
<span class="sd">            the weights for the data.</span>

<span class="sd">    Returns:</span>
<span class="sd">        float: The computed weighted mean.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If `data` or `weights` are not 1D arrays.</span>
<span class="sd">        ValueError: If the shapes of `data` and `weights` do not match.</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        data = np.array([1.0, 2.0, 3.0])</span>
<span class="sd">        weights = np.array([0.2, 0.5, 0.3])</span>
<span class="sd">        print(compute_weighted_mean(data, weights))  # =&gt; 2.1</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">compute_weighted_aggregate</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="n">weights</span><span class="p">,</span> <span class="n">factor</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="bbstat.statistics.compute_weighted_median" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">compute_weighted_median</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">weights</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">sorter</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Computes a weighted median of 1D data using linear interpolation.</p>
<p>This function calculates the weighted meadian of the given <code>data</code> array
based on the provided <code>weights</code> via <code>compute_weighted_quantile</code> with parameter
<code>quantile=0.5</code>.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>data</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="FArray = NDArray[np.floating]

  
      module-attribute
   (bbstat.statistics.FArray)" href="#bbstat.statistics.FArray">FArray</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A 1D array of numeric values representing
the sample data.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>weights</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="FArray = NDArray[np.floating]

  
      module-attribute
   (bbstat.statistics.FArray)" href="#bbstat.statistics.FArray">FArray</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A 1D array of numeric weights corresponding
to the data.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>sorter</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.integer">integer</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional array of indices that
sorts <code>data</code>.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>float</code></td>            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The interpolated weighted median value.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>data</code> and <code>weights</code> have different shapes or are not 1D.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <pre><code class="language-python">data = np.array([1.0, 2.0, 3.0])
weights = np.array([0.4, 0.2, 0.4])
print(compute_weighted_median(data, weights))  # =&gt; 2.25
</code></pre>
</details>

            <details class="quote">
              <summary>Source code in <code>bbstat/statistics.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">compute_weighted_median</span><span class="p">(</span>
    <span class="n">data</span><span class="p">:</span> <span class="n">FArray</span><span class="p">,</span>
    <span class="n">weights</span><span class="p">:</span> <span class="n">FArray</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">sorter</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">integer</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Computes a weighted median of 1D data using linear interpolation.</span>

<span class="sd">    This function calculates the weighted meadian of the given `data` array</span>
<span class="sd">    based on the provided `weights` via `compute_weighted_quantile` with parameter</span>
<span class="sd">    `quantile=0.5`.</span>

<span class="sd">    Args:</span>
<span class="sd">        data (FArray): A 1D array of numeric values representing</span>
<span class="sd">            the sample data.</span>
<span class="sd">        weights (FArray): A 1D array of numeric weights corresponding</span>
<span class="sd">            to the data.</span>
<span class="sd">        sorter (Optional[NDArray[np.integer]]): Optional array of indices that</span>
<span class="sd">            sorts `data`.</span>

<span class="sd">    Returns:</span>
<span class="sd">        float: The interpolated weighted median value.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If `data` and `weights` have different shapes or are not 1D.</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        data = np.array([1.0, 2.0, 3.0])</span>
<span class="sd">        weights = np.array([0.4, 0.2, 0.4])</span>
<span class="sd">        print(compute_weighted_median(data, weights))  # =&gt; 2.25</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">compute_weighted_quantile</span><span class="p">(</span>
        <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
        <span class="n">weights</span><span class="o">=</span><span class="n">weights</span><span class="p">,</span>
        <span class="n">quantile</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
        <span class="n">sorter</span><span class="o">=</span><span class="n">sorter</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="bbstat.statistics.compute_weighted_mutual_information" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">compute_weighted_mutual_information</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">weights</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Computes the weighted mutual information (dependency) between two 1D arrays.</p>
<p>This function calculates the mutual information dependency between two integer variables
using the direct mutual information formula on weighted joint distribution estimates.
The inputs <code>data_1</code> and <code>data_2</code> are expected to be 1D arrays of the same length, provided
as a tuple <code>data</code>. Each data point is assigned a weight from the <code>weights</code> array.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>data</code>
            </td>
            <td>
                  <code><span title="bbstat.statistics.IIArray">IIArray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A tuple of two 1D integer arrays <code>(data_1, data_2)</code>
of equal length.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>weights</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="FArray = NDArray[np.floating]

  
      module-attribute
   (bbstat.statistics.FArray)" href="#bbstat.statistics.FArray">FArray</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A 1D float array of weights, same length as
each array in <code>data</code>.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>normalize</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether or not to normalize the mutual information
to range [0, 1]. Default is True</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>float</code></td>            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The weighted mutual information.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the input arrays are not 1D or have mismatched lengths.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <pre><code class="language-python">data_1 = np.array([0, 0, 1])
data_2 = np.array([0, 1, 1])
weights = np.array([0.2, 0.5, 0.3])
print(compute_weighted_mutual_information((data_1, data_2), weights))  # =&gt; 0.146...
</code></pre>
</details>

<details class="notes" open>
  <summary>Notes</summary>
  <ul>
<li>The normalized result is bounded by [0, 1], where 0 indicates perfect independence and
  1 indicates perfect dependence.</li>
<li>The unnormalized result is bounded between 0 (perfect independence) and
  <code>min(H(data_0), H(data_1))</code>, where <code>H(data_0)</code> and <code>H(data_1)</code> are the entropies of
  the two variables. If we reach the upper bound and <code>H(data_0) == H(data_1)</code>,
  we have perfect dependence.</li>
</ul>
</details>

            <details class="quote">
              <summary>Source code in <code>bbstat/statistics.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">compute_weighted_mutual_information</span><span class="p">(</span>
    <span class="n">data</span><span class="p">:</span> <span class="n">IIArray</span><span class="p">,</span>
    <span class="n">weights</span><span class="p">:</span> <span class="n">FArray</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">normalize</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Computes the weighted mutual information (dependency) between two 1D arrays.</span>

<span class="sd">    This function calculates the mutual information dependency between two integer variables</span>
<span class="sd">    using the direct mutual information formula on weighted joint distribution estimates.</span>
<span class="sd">    The inputs `data_1` and `data_2` are expected to be 1D arrays of the same length, provided</span>
<span class="sd">    as a tuple `data`. Each data point is assigned a weight from the `weights` array.</span>

<span class="sd">    Args:</span>
<span class="sd">        data (IIArray): A tuple of two 1D integer arrays `(data_1, data_2)`</span>
<span class="sd">            of equal length.</span>
<span class="sd">        weights (FArray): A 1D float array of weights, same length as</span>
<span class="sd">            each array in `data`.</span>
<span class="sd">        normalize (bool, optional): Whether or not to normalize the mutual information</span>
<span class="sd">            to range [0, 1]. Default is True</span>

<span class="sd">    Returns:</span>
<span class="sd">        float: The weighted mutual information.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If the input arrays are not 1D or have mismatched lengths.</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        data_1 = np.array([0, 0, 1])</span>
<span class="sd">        data_2 = np.array([0, 1, 1])</span>
<span class="sd">        weights = np.array([0.2, 0.5, 0.3])</span>
<span class="sd">        print(compute_weighted_mutual_information((data_1, data_2), weights))  # =&gt; 0.146...</span>
<span class="sd">        ```</span>

<span class="sd">    Notes:</span>
<span class="sd">        - The normalized result is bounded by [0, 1], where 0 indicates perfect independence and</span>
<span class="sd">          1 indicates perfect dependence.</span>
<span class="sd">        - The unnormalized result is bounded between 0 (perfect independence) and</span>
<span class="sd">          `min(H(data_0), H(data_1))`, where `H(data_0)` and `H(data_1)` are the entropies of</span>
<span class="sd">          the two variables. If we reach the upper bound and `H(data_0) == H(data_1)`,</span>
<span class="sd">          we have perfect dependence.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">validate_arrays</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="n">weights</span><span class="p">)</span>
    <span class="n">active_sets</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">get_active_set</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
        <span class="n">get_active_set</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span>
    <span class="p">)</span>
    <span class="n">joint_distribution</span> <span class="o">=</span> <span class="n">weighted_discrete_joint_distribution</span><span class="p">(</span>
        <span class="n">data</span><span class="o">=</span><span class="n">active_sets</span><span class="p">,</span>
        <span class="n">weights</span><span class="o">=</span><span class="n">weights</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">distribution_0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">joint_distribution</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">distribution_1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">joint_distribution</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">divisor</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">outer</span><span class="p">(</span><span class="n">distribution_0</span><span class="p">,</span> <span class="n">distribution_1</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">joint_distribution</span> <span class="o">=</span> <span class="n">joint_distribution</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">non_zero</span> <span class="o">=</span> <span class="n">joint_distribution</span> <span class="o">&gt;</span> <span class="mf">0.0</span>
    <span class="n">mutual_information</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span>
        <span class="n">joint_distribution</span><span class="p">[</span><span class="n">non_zero</span><span class="p">]</span>
        <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">joint_distribution</span><span class="p">[</span><span class="n">non_zero</span><span class="p">]</span> <span class="o">/</span> <span class="n">divisor</span><span class="p">[</span><span class="n">non_zero</span><span class="p">])</span>
    <span class="p">)</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">mutual_information</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">normalize</span><span class="p">:</span>
        <span class="n">mask</span> <span class="o">=</span> <span class="n">distribution_0</span> <span class="o">&gt;</span> <span class="mf">0.0</span>
        <span class="n">entropy_0</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">distribution_0</span><span class="p">[</span><span class="n">mask</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">distribution_0</span><span class="p">[</span><span class="n">mask</span><span class="p">]))</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
        <span class="n">mask</span> <span class="o">=</span> <span class="n">distribution_1</span> <span class="o">&gt;</span> <span class="mf">0.0</span>
        <span class="n">entropy_1</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">distribution_1</span><span class="p">[</span><span class="n">mask</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">distribution_1</span><span class="p">[</span><span class="n">mask</span><span class="p">]))</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
        <span class="n">mutual_information</span> <span class="o">=</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="n">mutual_information</span> <span class="o">/</span> <span class="p">(</span><span class="n">entropy_0</span> <span class="o">+</span> <span class="n">entropy_1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">mutual_information</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="bbstat.statistics.compute_weighted_pearson_dependency" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">compute_weighted_pearson_dependency</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">weights</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">ddof</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Computes the weighted Pearson correlation coefficient (dependency) between two 1D arrays.</p>
<p>This function calculates the linear dependency between two variables using a weighted
version of Pearson's correlation coefficient. The inputs <code>data_1</code> and <code>data_2</code> are
expected to be 1D arrays of the same length, provided as a tuple <code>data</code>. Each data point
is assigned a weight from the <code>weights</code> array.</p>
<p>The function normalizes both variables by subtracting their weighted means and dividing
by their weighted standard deviations, then computes the weighted mean of the element-wise
product of these normalized arrays.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>data</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="FArray = NDArray[np.floating]

  
      module-attribute
   (bbstat.statistics.FArray)" href="#bbstat.statistics.FArray">FArray</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A tuple of two 1D float arrays <code>(data_1, data_2)</code>
of equal length.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>weights</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="FArray = NDArray[np.floating]

  
      module-attribute
   (bbstat.statistics.FArray)" href="#bbstat.statistics.FArray">FArray</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A 1D float array of weights, same length as
each array in <code>data</code>.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>ddof</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Delta degrees of freedom for standard deviation.
Defaults to 0 (population formula). Use 1 for sample-based correction.</p>
              </div>
            </td>
            <td>
                  <code>0</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>float</code></td>            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The weighted Pearson correlation coefficient in the range [-1, 1].</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the input arrays are not 1D or have mismatched lengths.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <pre><code class="language-python">data_1 = np.array([1.0, 2.0, 3.0])
data_2 = np.array([1.0, 2.0, 2.9])
weights = np.array([0.2, 0.5, 0.3])
print(compute_weighted_pearson_dependency((data_1, data_2), weights))  # =&gt; 0.998...
</code></pre>
</details>

<details class="notes" open>
  <summary>Notes</summary>
  <ul>
<li>The function relies on <code>compute_weighted_mean</code> and <code>compute_weighted_std</code>.</li>
<li>The correlation is computed using the formula:
    corr = weighted_mean(z1 * z2)
  where z1 and z2 are the standardized variables.</li>
<li>The result is bounded between -1 (perfect negative linear relationship)
  and 1 (perfect positive linear relationship), with 0 indicating no linear dependency.</li>
</ul>
</details>

            <details class="quote">
              <summary>Source code in <code>bbstat/statistics.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">compute_weighted_pearson_dependency</span><span class="p">(</span>
    <span class="n">data</span><span class="p">:</span> <span class="n">FFArray</span><span class="p">,</span>
    <span class="n">weights</span><span class="p">:</span> <span class="n">FArray</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">ddof</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Computes the weighted Pearson correlation coefficient (dependency) between two 1D arrays.</span>

<span class="sd">    This function calculates the linear dependency between two variables using a weighted</span>
<span class="sd">    version of Pearson&#39;s correlation coefficient. The inputs `data_1` and `data_2` are</span>
<span class="sd">    expected to be 1D arrays of the same length, provided as a tuple `data`. Each data point</span>
<span class="sd">    is assigned a weight from the `weights` array.</span>

<span class="sd">    The function normalizes both variables by subtracting their weighted means and dividing</span>
<span class="sd">    by their weighted standard deviations, then computes the weighted mean of the element-wise</span>
<span class="sd">    product of these normalized arrays.</span>

<span class="sd">    Args:</span>
<span class="sd">        data (FArray): A tuple of two 1D float arrays `(data_1, data_2)`</span>
<span class="sd">            of equal length.</span>
<span class="sd">        weights (FArray): A 1D float array of weights, same length as</span>
<span class="sd">            each array in `data`.</span>
<span class="sd">        ddof (int, optional): Delta degrees of freedom for standard deviation.</span>
<span class="sd">            Defaults to 0 (population formula). Use 1 for sample-based correction.</span>

<span class="sd">    Returns:</span>
<span class="sd">        float: The weighted Pearson correlation coefficient in the range [-1, 1].</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If the input arrays are not 1D or have mismatched lengths.</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        data_1 = np.array([1.0, 2.0, 3.0])</span>
<span class="sd">        data_2 = np.array([1.0, 2.0, 2.9])</span>
<span class="sd">        weights = np.array([0.2, 0.5, 0.3])</span>
<span class="sd">        print(compute_weighted_pearson_dependency((data_1, data_2), weights))  # =&gt; 0.998...</span>
<span class="sd">        ```</span>

<span class="sd">    Notes:</span>
<span class="sd">        - The function relies on `compute_weighted_mean` and `compute_weighted_std`.</span>
<span class="sd">        - The correlation is computed using the formula:</span>
<span class="sd">            corr = weighted_mean(z1 * z2)</span>
<span class="sd">          where z1 and z2 are the standardized variables.</span>
<span class="sd">        - The result is bounded between -1 (perfect negative linear relationship)</span>
<span class="sd">          and 1 (perfect positive linear relationship), with 0 indicating no linear dependency.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_1</span><span class="p">,</span> <span class="n">data_2</span> <span class="o">=</span> <span class="n">data</span>
    <span class="n">weighted_mean_1</span> <span class="o">=</span> <span class="n">compute_weighted_mean</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data_1</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="n">weights</span><span class="p">)</span>
    <span class="n">weighted_mean_2</span> <span class="o">=</span> <span class="n">compute_weighted_mean</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data_2</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="n">weights</span><span class="p">)</span>
    <span class="n">weighted_std_1</span> <span class="o">=</span> <span class="n">compute_weighted_std</span><span class="p">(</span>
        <span class="n">data</span><span class="o">=</span><span class="n">data_1</span><span class="p">,</span>
        <span class="n">weights</span><span class="o">=</span><span class="n">weights</span><span class="p">,</span>
        <span class="n">weighted_mean</span><span class="o">=</span><span class="n">weighted_mean_1</span><span class="p">,</span>
        <span class="n">ddof</span><span class="o">=</span><span class="n">ddof</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">weighted_std_2</span> <span class="o">=</span> <span class="n">compute_weighted_std</span><span class="p">(</span>
        <span class="n">data</span><span class="o">=</span><span class="n">data_2</span><span class="p">,</span>
        <span class="n">weights</span><span class="o">=</span><span class="n">weights</span><span class="p">,</span>
        <span class="n">weighted_mean</span><span class="o">=</span><span class="n">weighted_mean_2</span><span class="p">,</span>
        <span class="n">ddof</span><span class="o">=</span><span class="n">ddof</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">array_1</span> <span class="o">=</span> <span class="p">(</span><span class="n">data_1</span> <span class="o">-</span> <span class="n">weighted_mean_1</span><span class="p">)</span> <span class="o">/</span> <span class="n">weighted_std_1</span>
    <span class="n">array_2</span> <span class="o">=</span> <span class="p">(</span><span class="n">data_2</span> <span class="o">-</span> <span class="n">weighted_mean_2</span><span class="p">)</span> <span class="o">/</span> <span class="n">weighted_std_2</span>
    <span class="k">return</span> <span class="n">compute_weighted_mean</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">array_1</span> <span class="o">*</span> <span class="n">array_2</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="n">weights</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="bbstat.statistics.compute_weighted_percentile" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">compute_weighted_percentile</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">weights</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">percentile</span><span class="p">,</span> <span class="n">sorter</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Computes a weighted percentile of 1D data using linear interpolation.</p>
<p>This function calculates the weighted percentile of the given <code>data</code> array
based on the provided <code>weights</code> via <code>compute_weighted_quantile</code> with parameter
<code>quantile=0.01 * percentile</code>.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>data</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="FArray = NDArray[np.floating]

  
      module-attribute
   (bbstat.statistics.FArray)" href="#bbstat.statistics.FArray">FArray</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A 1D array of numeric values representing
the sample data.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>weights</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="FArray = NDArray[np.floating]

  
      module-attribute
   (bbstat.statistics.FArray)" href="#bbstat.statistics.FArray">FArray</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A 1D array of numeric weights corresponding
to the data.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>percentile</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The desired percentile in the interval [0, 100].</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>sorter</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.integer">integer</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional array of indices that
sorts <code>data</code>.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>float</code></td>            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The interpolated weighted percentile value.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>data</code> and <code>weights</code> have different shapes or are not 1D.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <pre><code class="language-python">data = np.array([1.0, 2.0, 3.0])
weights = np.array([0.2, 0.5, 0.3])
print(compute_weighted_percentile(data, weights, percentile=70))  # =&gt; 2.2
</code></pre>
</details>

            <details class="quote">
              <summary>Source code in <code>bbstat/statistics.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">compute_weighted_percentile</span><span class="p">(</span>
    <span class="n">data</span><span class="p">:</span> <span class="n">FArray</span><span class="p">,</span>
    <span class="n">weights</span><span class="p">:</span> <span class="n">FArray</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">percentile</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="n">sorter</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">integer</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Computes a weighted percentile of 1D data using linear interpolation.</span>

<span class="sd">    This function calculates the weighted percentile of the given `data` array</span>
<span class="sd">    based on the provided `weights` via `compute_weighted_quantile` with parameter</span>
<span class="sd">    `quantile=0.01 * percentile`.</span>

<span class="sd">    Args:</span>
<span class="sd">        data (FArray): A 1D array of numeric values representing</span>
<span class="sd">            the sample data.</span>
<span class="sd">        weights (FArray): A 1D array of numeric weights corresponding</span>
<span class="sd">            to the data.</span>
<span class="sd">        percentile (float): The desired percentile in the interval [0, 100].</span>
<span class="sd">        sorter (Optional[NDArray[np.integer]]): Optional array of indices that</span>
<span class="sd">            sorts `data`.</span>

<span class="sd">    Returns:</span>
<span class="sd">        float: The interpolated weighted percentile value.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If `data` and `weights` have different shapes or are not 1D.</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        data = np.array([1.0, 2.0, 3.0])</span>
<span class="sd">        weights = np.array([0.2, 0.5, 0.3])</span>
<span class="sd">        print(compute_weighted_percentile(data, weights, percentile=70))  # =&gt; 2.2</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">compute_weighted_quantile</span><span class="p">(</span>
        <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
        <span class="n">weights</span><span class="o">=</span><span class="n">weights</span><span class="p">,</span>
        <span class="n">quantile</span><span class="o">=</span><span class="mf">0.01</span> <span class="o">*</span> <span class="n">percentile</span><span class="p">,</span>
        <span class="n">sorter</span><span class="o">=</span><span class="n">sorter</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="bbstat.statistics.compute_weighted_probability" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">compute_weighted_probability</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">weights</span><span class="p">,</span> <span class="n">state</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Computes a weighted probability of a state within 1D code data.</p>
<p>This function calculates the weighted probability of a <code>state</code> by summing
the <code>weights</code> which coincide with <code>data == state</code>.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>data</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="IArray = NDArray[np.integer]

  
      module-attribute
   (bbstat.statistics.IArray)" href="#bbstat.statistics.IArray">IArray</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A 1D array of numeric values representing
the sample data in code format.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>weights</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="FArray = NDArray[np.floating]

  
      module-attribute
   (bbstat.statistics.FArray)" href="#bbstat.statistics.FArray">FArray</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A 1D array of numeric weights corresponding
to the data.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>state</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The state for which we estimate the probability.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>float</code></td>            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The weighted probability value.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>data</code> and <code>weights</code> have different shapes or are not 1D,
or if <code>state</code> is not in <code>data</code>.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <pre><code class="language-python">data = np.array([1, 0, 0])
weights = np.array([0.4, 0.2, 0.4])
print(compute_weighted_probability(data, weights, state=0))  # =&gt; 0.6
</code></pre>
</details>

            <details class="quote">
              <summary>Source code in <code>bbstat/statistics.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">compute_weighted_probability</span><span class="p">(</span>
    <span class="n">data</span><span class="p">:</span> <span class="n">IArray</span><span class="p">,</span>
    <span class="n">weights</span><span class="p">:</span> <span class="n">FArray</span><span class="p">,</span>
    <span class="n">state</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Computes a weighted probability of a state within 1D code data.</span>

<span class="sd">    This function calculates the weighted probability of a `state` by summing</span>
<span class="sd">    the `weights` which coincide with `data == state`.</span>

<span class="sd">    Args:</span>
<span class="sd">        data (IArray): A 1D array of numeric values representing</span>
<span class="sd">            the sample data in code format.</span>
<span class="sd">        weights (FArray): A 1D array of numeric weights corresponding</span>
<span class="sd">            to the data.</span>
<span class="sd">        state (int): The state for which we estimate the probability.</span>

<span class="sd">    Returns:</span>
<span class="sd">        float: The weighted probability value.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If `data` and `weights` have different shapes or are not 1D,</span>
<span class="sd">            or if `state` is not in `data`.</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        data = np.array([1, 0, 0])</span>
<span class="sd">        weights = np.array([0.4, 0.2, 0.4])</span>
<span class="sd">        print(compute_weighted_probability(data, weights, state=0))  # =&gt; 0.6</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">validate_array</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="n">weights</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">state</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Incompatible parameter </span><span class="si">{</span><span class="n">state</span><span class="si">=:}</span><span class="s2">: not included in data.&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">weights</span><span class="p">[</span><span class="n">data</span> <span class="o">==</span> <span class="n">state</span><span class="p">])</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="bbstat.statistics.compute_weighted_quantile" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">compute_weighted_quantile</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">weights</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">quantile</span><span class="p">,</span> <span class="n">sorter</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Computes a weighted quantile of 1D data using linear interpolation.</p>
<p>This function calculates the weighted quantile of the given <code>data</code> array
based on the provided <code>weights</code>. It uses a normalized cumulative weight
distribution to determine the interpolated quantile value. The computation
assumes both <code>data</code> and <code>weights</code> are 1D arrays of equal length.</p>
<p>A precomputed <code>sorter</code> (array of indices that would sort <code>data</code>) can be
optionally provided to avoid recomputing it internally.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>data</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="FArray = NDArray[np.floating]

  
      module-attribute
   (bbstat.statistics.FArray)" href="#bbstat.statistics.FArray">FArray</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A 1D array of numeric values representing
the sample data.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>weights</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="FArray = NDArray[np.floating]

  
      module-attribute
   (bbstat.statistics.FArray)" href="#bbstat.statistics.FArray">FArray</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A 1D array of numeric weights corresponding
to the data.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>quantile</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The desired quantile in the interval [0, 1].</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>sorter</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.integer">integer</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional array of indices that
sorts <code>data</code>.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>float</code></td>            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The interpolated weighted quantile value.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>data</code> and <code>weights</code> have different shapes or are not 1D.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <pre><code class="language-python">data = np.array([1.0, 2.0, 3.0])
weights = np.array([0.2, 0.5, 0.3])
print(compute_weighted_quantile(data, weights, quantile=0.7))  # =&gt; 2.2
</code></pre>
</details>

<details class="notes" open>
  <summary>Notes</summary>
  <ul>
<li>If <code>quantile</code> is less than or equal to the minimum cumulative weight,
  the smallest data point is returned.</li>
<li>If <code>quantile</code> is greater than or equal to the maximum cumulative weight,
  the largest data point is returned.</li>
<li>Linear interpolation is used between the two closest surrounding data points.</li>
<li>Providing a precomputed <code>sorter</code> can optimize performance in repeated calls.</li>
</ul>
</details>

            <details class="quote">
              <summary>Source code in <code>bbstat/statistics.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">compute_weighted_quantile</span><span class="p">(</span>
    <span class="n">data</span><span class="p">:</span> <span class="n">FArray</span><span class="p">,</span>
    <span class="n">weights</span><span class="p">:</span> <span class="n">FArray</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">quantile</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="n">sorter</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">IArray</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Computes a weighted quantile of 1D data using linear interpolation.</span>

<span class="sd">    This function calculates the weighted quantile of the given `data` array</span>
<span class="sd">    based on the provided `weights`. It uses a normalized cumulative weight</span>
<span class="sd">    distribution to determine the interpolated quantile value. The computation</span>
<span class="sd">    assumes both `data` and `weights` are 1D arrays of equal length.</span>

<span class="sd">    A precomputed `sorter` (array of indices that would sort `data`) can be</span>
<span class="sd">    optionally provided to avoid recomputing it internally.</span>

<span class="sd">    Args:</span>
<span class="sd">        data (FArray): A 1D array of numeric values representing</span>
<span class="sd">            the sample data.</span>
<span class="sd">        weights (FArray): A 1D array of numeric weights corresponding</span>
<span class="sd">            to the data.</span>
<span class="sd">        quantile (float): The desired quantile in the interval [0, 1].</span>
<span class="sd">        sorter (Optional[NDArray[np.integer]]): Optional array of indices that</span>
<span class="sd">            sorts `data`.</span>

<span class="sd">    Returns:</span>
<span class="sd">        float: The interpolated weighted quantile value.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If `data` and `weights` have different shapes or are not 1D.</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        data = np.array([1.0, 2.0, 3.0])</span>
<span class="sd">        weights = np.array([0.2, 0.5, 0.3])</span>
<span class="sd">        print(compute_weighted_quantile(data, weights, quantile=0.7))  # =&gt; 2.2</span>
<span class="sd">        ```</span>

<span class="sd">    Notes:</span>
<span class="sd">        - If `quantile` is less than or equal to the minimum cumulative weight,</span>
<span class="sd">          the smallest data point is returned.</span>
<span class="sd">        - If `quantile` is greater than or equal to the maximum cumulative weight,</span>
<span class="sd">          the largest data point is returned.</span>
<span class="sd">        - Linear interpolation is used between the two closest surrounding data points.</span>
<span class="sd">        - Providing a precomputed `sorter` can optimize performance in repeated calls.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">validate_array</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="n">weights</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">sorter</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">sorter</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">sorter</span><span class="o">.</span><span class="n">shape</span> <span class="o">!=</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid parameter </span><span class="si">{</span><span class="n">sorter</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">: must match </span><span class="si">{</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
    <span class="n">cumulative_weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">weights</span><span class="p">[</span><span class="n">sorter</span><span class="p">])</span>
    <span class="n">cw_lo</span><span class="p">,</span> <span class="n">cw_hi</span> <span class="o">=</span> <span class="n">cumulative_weights</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
    <span class="n">cumulative_weights</span> <span class="o">-=</span> <span class="n">cw_lo</span>
    <span class="n">cumulative_weights</span> <span class="o">/=</span> <span class="n">cw_hi</span> <span class="o">-</span> <span class="n">cw_lo</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">sorter</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">quantile</span> <span class="o">&lt;=</span> <span class="n">cumulative_weights</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
        <span class="k">return</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">quantile</span> <span class="o">&gt;=</span> <span class="n">cumulative_weights</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
        <span class="k">return</span> <span class="n">data</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">searchsorted</span><span class="p">(</span><span class="n">cumulative_weights</span><span class="p">,</span> <span class="n">quantile</span><span class="p">)</span>
    <span class="n">w_lo</span><span class="p">,</span> <span class="n">w_hi</span> <span class="o">=</span> <span class="n">cumulative_weights</span><span class="p">[[</span><span class="n">idx</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">idx</span><span class="p">]]</span>
    <span class="n">s_lo</span><span class="p">,</span> <span class="n">s_hi</span> <span class="o">=</span> <span class="n">data</span><span class="p">[[</span><span class="n">idx</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">idx</span><span class="p">]]</span>
    <span class="n">w</span> <span class="o">=</span> <span class="p">(</span><span class="n">quantile</span> <span class="o">-</span> <span class="n">w_lo</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">w_hi</span> <span class="o">-</span> <span class="n">w_lo</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">s_lo</span> <span class="o">+</span> <span class="n">w</span> <span class="o">*</span> <span class="p">(</span><span class="n">s_hi</span> <span class="o">-</span> <span class="n">s_lo</span><span class="p">))</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="bbstat.statistics.compute_weighted_self_information" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">compute_weighted_self_information</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">weights</span><span class="p">,</span> <span class="n">state</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Computes a weighted self-information of a state within 1D code data.</p>
<p>This function calculates the weighted probability of a <code>state</code> by summing
the <code>weights</code> which coincide with <code>data == state</code>. The self-information then
computes as negative logarithm of the weighted probability.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>data</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="IArray = NDArray[np.integer]

  
      module-attribute
   (bbstat.statistics.IArray)" href="#bbstat.statistics.IArray">IArray</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A 1D array of numeric values representing
the sample data in code format.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>weights</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="FArray = NDArray[np.floating]

  
      module-attribute
   (bbstat.statistics.FArray)" href="#bbstat.statistics.FArray">FArray</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A 1D array of numeric weights corresponding
to the data.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>state</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The state for which we estimate the self-information.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>float</code></td>            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The weighted self-information value.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>data</code> and <code>weights</code> have different shapes or are not 1D,
or if <code>state</code> is not in <code>data</code>.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <pre><code class="language-python">data = np.array([1, 0, 0])
weights = np.array([0.4, 0.2, 0.4])
print(compute_weighted_self_information(data, weights, state=0))  # =&gt; 0.510...
</code></pre>
</details>

            <details class="quote">
              <summary>Source code in <code>bbstat/statistics.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">compute_weighted_self_information</span><span class="p">(</span>
    <span class="n">data</span><span class="p">:</span> <span class="n">IArray</span><span class="p">,</span>
    <span class="n">weights</span><span class="p">:</span> <span class="n">FArray</span><span class="p">,</span>
    <span class="n">state</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Computes a weighted self-information of a state within 1D code data.</span>

<span class="sd">    This function calculates the weighted probability of a `state` by summing</span>
<span class="sd">    the `weights` which coincide with `data == state`. The self-information then</span>
<span class="sd">    computes as negative logarithm of the weighted probability.</span>

<span class="sd">    Args:</span>
<span class="sd">        data (IArray): A 1D array of numeric values representing</span>
<span class="sd">            the sample data in code format.</span>
<span class="sd">        weights (FArray): A 1D array of numeric weights corresponding</span>
<span class="sd">            to the data.</span>
<span class="sd">        state (int): The state for which we estimate the self-information.</span>

<span class="sd">    Returns:</span>
<span class="sd">        float: The weighted self-information value.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If `data` and `weights` have different shapes or are not 1D,</span>
<span class="sd">            or if `state` is not in `data`.</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        data = np.array([1, 0, 0])</span>
<span class="sd">        weights = np.array([0.4, 0.2, 0.4])</span>
<span class="sd">        print(compute_weighted_self_information(data, weights, state=0))  # =&gt; 0.510...</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">probability</span> <span class="o">=</span> <span class="n">compute_weighted_probability</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="n">weights</span><span class="p">,</span> <span class="n">state</span><span class="o">=</span><span class="n">state</span><span class="p">)</span>
    <span class="k">return</span> <span class="o">-</span><span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">probability</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="bbstat.statistics.compute_weighted_spearman_dependency" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">compute_weighted_spearman_dependency</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">weights</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">ddof</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Computes the weighted Spearman rank correlation coefficient between two 1D arrays.</p>
<p>This function measures the monotonic relationship between two variables by computing
the weighted Pearson correlation between their ranked values (i.e., their order statistics).
It is particularly useful for assessing non-linear relationships.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>data</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="FArray = NDArray[np.floating]

  
      module-attribute
   (bbstat.statistics.FArray)" href="#bbstat.statistics.FArray">FArray</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A tuple of two 1D float arrays <code>(data_1, data_2)</code>
of equal length.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>weights</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="FArray = NDArray[np.floating]

  
      module-attribute
   (bbstat.statistics.FArray)" href="#bbstat.statistics.FArray">FArray</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A 1D float array of weights, same length as
each array in <code>data</code>.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>ddof</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Delta degrees of freedom for standard deviation.
Defaults to 0 (population formula). Use 1 for sample-based correction.</p>
              </div>
            </td>
            <td>
                  <code>0</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>float</code></td>            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The weighted Spearman rank correlation coefficient in the range [-1, 1].</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the input arrays are not 1D or have mismatched lengths.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <pre><code class="language-python">data_1 = np.array([1.0, 2.0, 3.0])
data_2 = np.array([0.3, 0.2, 0.1])
weights = np.array([0.2, 0.5, 0.3])
print(compute_weighted_spearman_dependency((data_1, data_2), weights))  # =&gt; -0.9999...
</code></pre>
</details>

<details class="notes" open>
  <summary>Notes</summary>
  <ul>
<li>Internally, ranks are computed using <code>scipy.stats.rankdata</code>, which handles ties
  by assigning average ranks.</li>
<li>The Spearman coefficient is equivalent to the Pearson correlation between
  rank-transformed data.</li>
<li>Output is bounded between -1 (perfect inverse monotonic relationship)
  and 1 (perfect direct monotonic relationship), with 0 indicating no
  monotonic correlation.</li>
<li>Weights are applied after ranking.</li>
</ul>
</details>

            <details class="quote">
              <summary>Source code in <code>bbstat/statistics.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">compute_weighted_spearman_dependency</span><span class="p">(</span>
    <span class="n">data</span><span class="p">:</span> <span class="n">FFArray</span><span class="p">,</span>
    <span class="n">weights</span><span class="p">:</span> <span class="n">FArray</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">ddof</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Computes the weighted Spearman rank correlation coefficient between two 1D arrays.</span>

<span class="sd">    This function measures the monotonic relationship between two variables by computing</span>
<span class="sd">    the weighted Pearson correlation between their ranked values (i.e., their order statistics).</span>
<span class="sd">    It is particularly useful for assessing non-linear relationships.</span>

<span class="sd">    Args:</span>
<span class="sd">        data (FArray): A tuple of two 1D float arrays `(data_1, data_2)`</span>
<span class="sd">            of equal length.</span>
<span class="sd">        weights (FArray): A 1D float array of weights, same length as</span>
<span class="sd">            each array in `data`.</span>
<span class="sd">        ddof (int, optional): Delta degrees of freedom for standard deviation.</span>
<span class="sd">            Defaults to 0 (population formula). Use 1 for sample-based correction.</span>

<span class="sd">    Returns:</span>
<span class="sd">        float: The weighted Spearman rank correlation coefficient in the range [-1, 1].</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If the input arrays are not 1D or have mismatched lengths.</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        data_1 = np.array([1.0, 2.0, 3.0])</span>
<span class="sd">        data_2 = np.array([0.3, 0.2, 0.1])</span>
<span class="sd">        weights = np.array([0.2, 0.5, 0.3])</span>
<span class="sd">        print(compute_weighted_spearman_dependency((data_1, data_2), weights))  # =&gt; -0.9999...</span>
<span class="sd">        ```</span>

<span class="sd">    Notes:</span>
<span class="sd">        - Internally, ranks are computed using `scipy.stats.rankdata`, which handles ties</span>
<span class="sd">          by assigning average ranks.</span>
<span class="sd">        - The Spearman coefficient is equivalent to the Pearson correlation between</span>
<span class="sd">          rank-transformed data.</span>
<span class="sd">        - Output is bounded between -1 (perfect inverse monotonic relationship)</span>
<span class="sd">          and 1 (perfect direct monotonic relationship), with 0 indicating no</span>
<span class="sd">          monotonic correlation.</span>
<span class="sd">        - Weights are applied after ranking.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_1</span><span class="p">,</span> <span class="n">data_2</span> <span class="o">=</span> <span class="n">data</span>
    <span class="n">ranks_1</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="n">FArray</span><span class="p">,</span> <span class="n">rankdata</span><span class="p">(</span><span class="n">data_1</span><span class="p">))</span>
    <span class="n">ranks_2</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="n">FArray</span><span class="p">,</span> <span class="n">rankdata</span><span class="p">(</span><span class="n">data_2</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">compute_weighted_pearson_dependency</span><span class="p">(</span>
        <span class="n">data</span><span class="o">=</span><span class="p">(</span><span class="n">ranks_1</span><span class="p">,</span> <span class="n">ranks_2</span><span class="p">),</span>
        <span class="n">weights</span><span class="o">=</span><span class="n">weights</span><span class="p">,</span>
        <span class="n">ddof</span><span class="o">=</span><span class="n">ddof</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="bbstat.statistics.compute_weighted_std" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">compute_weighted_std</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">weights</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">weighted_mean</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ddof</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Computes a weighted standard deviation of the input data.</p>
<p>This function calculates the weighted standard deviation of the
input <code>data</code> and <code>weights</code> via the square root of the
<code>compute_weighted_variance</code> function.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>data</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="FArray = NDArray[np.floating]

  
      module-attribute
   (bbstat.statistics.FArray)" href="#bbstat.statistics.FArray">FArray</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A 1D array of numeric values representing
the data for which we want the standard deviation.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>weights</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="FArray = NDArray[np.floating]

  
      module-attribute
   (bbstat.statistics.FArray)" href="#bbstat.statistics.FArray">FArray</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A 1D array of numeric values representing
the weights for the data.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>weighted_mean</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The weighted mean of the data (default is
None). If missing, this value is computed via <code>compute_weighted_mean</code>
via <code>compute_weighted_variance</code>.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>ddof</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Delta degrees of freedom.
Defaults to 0 (population formula). Use 1 for sample-based correction.</p>
              </div>
            </td>
            <td>
                  <code>0</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>float</code></td>            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The computed weighted standard deviation.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>data</code> or <code>weights</code> are not 1D arrays.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the shapes of <code>data</code> and <code>weights</code> do not match.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <pre><code class="language-python">data = np.array([1.0, 2.0, 3.0])
weights = np.array([0.2, 0.5, 0.3])
print(compute_weighted_std(data, weights))  # =&gt; 0.7
</code></pre>
</details>

            <details class="quote">
              <summary>Source code in <code>bbstat/statistics.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span>
<span class="normal">748</span>
<span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span>
<span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">compute_weighted_std</span><span class="p">(</span>
    <span class="n">data</span><span class="p">:</span> <span class="n">FArray</span><span class="p">,</span>
    <span class="n">weights</span><span class="p">:</span> <span class="n">FArray</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">weighted_mean</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">ddof</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Computes a weighted standard deviation of the input data.</span>

<span class="sd">    This function calculates the weighted standard deviation of the</span>
<span class="sd">    input `data` and `weights` via the square root of the</span>
<span class="sd">    `compute_weighted_variance` function.</span>

<span class="sd">    Args:</span>
<span class="sd">        data (FArray): A 1D array of numeric values representing</span>
<span class="sd">            the data for which we want the standard deviation.</span>
<span class="sd">        weights (FArray): A 1D array of numeric values representing</span>
<span class="sd">            the weights for the data.</span>
<span class="sd">        weighted_mean (float, optional): The weighted mean of the data (default is</span>
<span class="sd">            None). If missing, this value is computed via `compute_weighted_mean`</span>
<span class="sd">            via `compute_weighted_variance`.</span>
<span class="sd">        ddof (int, optional): Delta degrees of freedom.</span>
<span class="sd">            Defaults to 0 (population formula). Use 1 for sample-based correction.</span>

<span class="sd">    Returns:</span>
<span class="sd">        float: The computed weighted standard deviation.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If `data` or `weights` are not 1D arrays.</span>
<span class="sd">        ValueError: If the shapes of `data` and `weights` do not match.</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        data = np.array([1.0, 2.0, 3.0])</span>
<span class="sd">        weights = np.array([0.2, 0.5, 0.3])</span>
<span class="sd">        print(compute_weighted_std(data, weights))  # =&gt; 0.7</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">weighted_variance</span> <span class="o">=</span> <span class="n">compute_weighted_variance</span><span class="p">(</span>
        <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
        <span class="n">weights</span><span class="o">=</span><span class="n">weights</span><span class="p">,</span>
        <span class="n">weighted_mean</span><span class="o">=</span><span class="n">weighted_mean</span><span class="p">,</span>
        <span class="n">ddof</span><span class="o">=</span><span class="n">ddof</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">weighted_variance</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="bbstat.statistics.compute_weighted_sum" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">compute_weighted_sum</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">weights</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Computes a weighted sum of the input data.</p>
<p>This function calculates the weighted sum of the input <code>data</code>
and <code>weights</code> via the <code>compute_weighted_aggregate</code> function with
<code>factor=len(data)</code>.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>data</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="FArray = NDArray[np.floating]

  
      module-attribute
   (bbstat.statistics.FArray)" href="#bbstat.statistics.FArray">FArray</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A 1D array of numeric values representing
the data to be summed.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>weights</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="FArray = NDArray[np.floating]

  
      module-attribute
   (bbstat.statistics.FArray)" href="#bbstat.statistics.FArray">FArray</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A 1D array of numeric values representing
the weights for the data.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>float</code></td>            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The computed weighted sum.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>data</code> or <code>weights</code> are not 1D arrays.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the shapes of <code>data</code> and <code>weights</code> do not match.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <pre><code class="language-python">data = np.array([1.0, 2.0, 3.0])
weights = np.array([0.2, 0.5, 0.3])
print(compute_weighted_sum(data, weights))  # =&gt; 6.3
</code></pre>
</details>

            <details class="quote">
              <summary>Source code in <code>bbstat/statistics.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span>
<span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span>
<span class="normal">792</span>
<span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span>
<span class="normal">796</span>
<span class="normal">797</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">compute_weighted_sum</span><span class="p">(</span>
    <span class="n">data</span><span class="p">:</span> <span class="n">FArray</span><span class="p">,</span>
    <span class="n">weights</span><span class="p">:</span> <span class="n">FArray</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Computes a weighted sum of the input data.</span>

<span class="sd">    This function calculates the weighted sum of the input `data`</span>
<span class="sd">    and `weights` via the `compute_weighted_aggregate` function with</span>
<span class="sd">    `factor=len(data)`.</span>

<span class="sd">    Args:</span>
<span class="sd">        data (FArray): A 1D array of numeric values representing</span>
<span class="sd">            the data to be summed.</span>
<span class="sd">        weights (FArray): A 1D array of numeric values representing</span>
<span class="sd">            the weights for the data.</span>

<span class="sd">    Returns:</span>
<span class="sd">        float: The computed weighted sum.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If `data` or `weights` are not 1D arrays.</span>
<span class="sd">        ValueError: If the shapes of `data` and `weights` do not match.</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        data = np.array([1.0, 2.0, 3.0])</span>
<span class="sd">        weights = np.array([0.2, 0.5, 0.3])</span>
<span class="sd">        print(compute_weighted_sum(data, weights))  # =&gt; 6.3</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">compute_weighted_aggregate</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="n">weights</span><span class="p">,</span> <span class="n">factor</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="bbstat.statistics.compute_weighted_variance" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">compute_weighted_variance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">weights</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">weighted_mean</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ddof</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Computes a weighted variance of the input data.</p>
<p>This function calculates the weighted variance of the input <code>data</code>
and <code>weights</code> via the <code>compute_weighted_aggregate</code> function with
<code>factor=len(data) / (len(data) - ddof)</code>, where <code>ddof</code> specifies the
delta degrees of freedom.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>data</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="FArray = NDArray[np.floating]

  
      module-attribute
   (bbstat.statistics.FArray)" href="#bbstat.statistics.FArray">FArray</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A 1D array of numeric values representing
the data for which we want the variance.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>weights</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="FArray = NDArray[np.floating]

  
      module-attribute
   (bbstat.statistics.FArray)" href="#bbstat.statistics.FArray">FArray</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A 1D array of numeric values representing
the weights for the data.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>weighted_mean</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The weighted mean of the data (default is
None). If missing, this value is computed via <code>compute_weighted_mean</code>.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>ddof</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Delta degrees of freedom.
Defaults to 0 (population formula). Use 1 for sample-based correction.</p>
              </div>
            </td>
            <td>
                  <code>0</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>float</code></td>            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The computed weighted variance.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>data</code> or <code>weights</code> are not 1D arrays.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the shapes of <code>data</code> and <code>weights</code> do not match.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <pre><code class="language-python">data = np.array([1.0, 2.0, 3.0])
weights = np.array([0.2, 0.5, 0.3])
print(compute_weighted_variance(data, weights))  # =&gt; 0.49
print(compute_weighted_variance(data, weights, ddof=1))  # =&gt; 0.735
</code></pre>
</details>

            <details class="quote">
              <summary>Source code in <code>bbstat/statistics.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">800</span>
<span class="normal">801</span>
<span class="normal">802</span>
<span class="normal">803</span>
<span class="normal">804</span>
<span class="normal">805</span>
<span class="normal">806</span>
<span class="normal">807</span>
<span class="normal">808</span>
<span class="normal">809</span>
<span class="normal">810</span>
<span class="normal">811</span>
<span class="normal">812</span>
<span class="normal">813</span>
<span class="normal">814</span>
<span class="normal">815</span>
<span class="normal">816</span>
<span class="normal">817</span>
<span class="normal">818</span>
<span class="normal">819</span>
<span class="normal">820</span>
<span class="normal">821</span>
<span class="normal">822</span>
<span class="normal">823</span>
<span class="normal">824</span>
<span class="normal">825</span>
<span class="normal">826</span>
<span class="normal">827</span>
<span class="normal">828</span>
<span class="normal">829</span>
<span class="normal">830</span>
<span class="normal">831</span>
<span class="normal">832</span>
<span class="normal">833</span>
<span class="normal">834</span>
<span class="normal">835</span>
<span class="normal">836</span>
<span class="normal">837</span>
<span class="normal">838</span>
<span class="normal">839</span>
<span class="normal">840</span>
<span class="normal">841</span>
<span class="normal">842</span>
<span class="normal">843</span>
<span class="normal">844</span>
<span class="normal">845</span>
<span class="normal">846</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">compute_weighted_variance</span><span class="p">(</span>
    <span class="n">data</span><span class="p">:</span> <span class="n">FArray</span><span class="p">,</span>
    <span class="n">weights</span><span class="p">:</span> <span class="n">FArray</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">weighted_mean</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">ddof</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Computes a weighted variance of the input data.</span>

<span class="sd">    This function calculates the weighted variance of the input `data`</span>
<span class="sd">    and `weights` via the `compute_weighted_aggregate` function with</span>
<span class="sd">    `factor=len(data) / (len(data) - ddof)`, where `ddof` specifies the</span>
<span class="sd">    delta degrees of freedom.</span>

<span class="sd">    Args:</span>
<span class="sd">        data (FArray): A 1D array of numeric values representing</span>
<span class="sd">            the data for which we want the variance.</span>
<span class="sd">        weights (FArray): A 1D array of numeric values representing</span>
<span class="sd">            the weights for the data.</span>
<span class="sd">        weighted_mean (float, optional): The weighted mean of the data (default is</span>
<span class="sd">            None). If missing, this value is computed via `compute_weighted_mean`.</span>
<span class="sd">        ddof (int, optional): Delta degrees of freedom.</span>
<span class="sd">            Defaults to 0 (population formula). Use 1 for sample-based correction.</span>

<span class="sd">    Returns:</span>
<span class="sd">        float: The computed weighted variance.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If `data` or `weights` are not 1D arrays.</span>
<span class="sd">        ValueError: If the shapes of `data` and `weights` do not match.</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        data = np.array([1.0, 2.0, 3.0])</span>
<span class="sd">        weights = np.array([0.2, 0.5, 0.3])</span>
<span class="sd">        print(compute_weighted_variance(data, weights))  # =&gt; 0.49</span>
<span class="sd">        print(compute_weighted_variance(data, weights, ddof=1))  # =&gt; 0.735</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">weighted_mean</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">weighted_mean</span> <span class="o">=</span> <span class="n">compute_weighted_mean</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="n">weights</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">compute_weighted_aggregate</span><span class="p">(</span>
        <span class="n">data</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">data</span> <span class="o">-</span> <span class="n">weighted_mean</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">),</span>
        <span class="n">weights</span><span class="o">=</span><span class="n">weights</span><span class="p">,</span>
        <span class="n">factor</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">-</span> <span class="n">ddof</span><span class="p">),</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script src="../js/bootstrap.bundle.min.js"></script>
        <script>
            var base_url = "..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../js/base.js"></script>
        <script src="../search/main.js"></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <p>From here you can search these documents. Enter your search terms below.</p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results" data-no-results-text="No results found"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
